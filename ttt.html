
<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Il Mio Condominio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'condo-primary': '#0284c7', // sky-600
              'condo-primary-dark': '#0369a1', // sky-700
              'condo-secondary': '#10b981', // emerald-500
              'condo-text': '#334155', // slate-700
              'condo-dark-text': '#1e293b', // slate-800
              'condo-light-text': '#64748b', // slate-500 (for less emphasis text)
            }
          }
        },
        plugins: [],
      }
    </script>
    <style>
      /* Custom scrollbar for webkit browsers */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #f1f5f9; /* slate-100 */
      }
      ::-webkit-scrollbar-thumb {
        background: #94a3b8; /* slate-400 */
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #64748b; /* slate-500 */
      }
      /* Basic body styling for better cross-browser font rendering */
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
      /* Add a subtle fade-in animation */
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .animate-fadeIn {
        animation: fadeIn 0.5s ease-out forwards;
      }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.1.0",
    "react-dom/": "https://esm.sh/react-dom@^19.1.0/",
    "react/": "https://esm.sh/react@^19.1.0/",
    "react-router-dom": "https://esm.sh/react-router-dom@6.25.1",
    "@google/genai": "https://esm.sh/@google/genai@^1.4.0"
  }
}
</script>
</head>
<body class="bg-slate-100">
    <div id="root"></div>
    <script type="module">
// From react and react-dom (will be provided by importmap)
import React, { useState, useEffect, useCallback, useRef } from 'react';
import ReactDOM from 'react-dom/client';
import { HashRouter, Routes, Route, NavLink, Navigate, Link, useLocation, useNavigate } from 'react-router-dom';

// Content from types.ts (runtime relevant parts)
const IssueStatus = {
  APERTO: 'Aperto',
  IN_ELABORAZIONE: 'In Elaborazione',
  RISOLTO: 'Risolto',
  CHIUSO: 'Chiuso',
};
// FeeStatus values are used directly as strings, no object needed.
// IssueUrgency values are used directly as strings.

// Content from services/localStorageService.ts
const getItem = (key) => {
  try {
    const item = localStorage.getItem(key);
    return item ? JSON.parse(item) : null;
  } catch (error) {
    console.error(`Errore nel recuperare ${key} da localStorage:`, error);
    return null;
  }
};

const setItem = (key, value) => {
  try {
    localStorage.setItem(key, JSON.stringify(value));
  } catch (error) {
    console.error(`Errore nel salvare ${key} in localStorage:`, error);
  }
};

const removeItem = (key) => {
  try {
    localStorage.removeItem(key);
  } catch (error) {
    console.error(`Errore nel rimuovere ${key} da localStorage:`, error);
  }
};

// Content from components/Icons.tsx
const HomeIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: "1.5", stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h7.5" })
  )
);

const BellIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: "1.5", stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.267 24.267 0 01-5.714 0m5.714 0a3 3 0 01-5.714 0" })
  )
);

const DocumentTextIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: "1.5", stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" })
  )
);

const WrenchScrewdriverIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: "1.5", stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.527-1.032.294-2.078-.65-3.124l-2.474-2.474c-1.046-.957-2.092-1.18-3.124-.65L2.25 12l6.874 6.874c.428.428.99.722 1.596.858l3.032-2.496z" }),
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M9.75 15.75L3 22.5M15 9.75L21.75 3" })
  )
);

const CalendarDaysIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: "1.5", stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" })
  )
);

const UsersIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: "1.5", stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" })
  )
);

const ChatBubbleLeftEllipsisIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: "1.5", stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M21 12c0 4.556-3.862 8.25-8.625 8.25S3.75 16.556 3.75 12c0-4.556 3.862-8.25 8.625-8.25S21 7.444 21 12z" })
  )
);

const BuildingOfficeIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: "1.5", stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h6M9 12h6m-6 5.25h6M7.5 3V1.5m9 1.5V1.5" })
  )
);

const PlusIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: "1.5", stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M12 4.5v15m7.5-7.5h-15" })
  )
);

const TrashIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: "1.5", stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12.56 0c1.153 0 2.243.096 3.288.257m0 0v1.875c0 .621.504 1.125 1.125 1.125h1.5c.621 0 1.125-.504 1.125-1.125v-1.875m0 0A2.25 2.25 0 009.75 3h4.5c1.243 0 2.25.933 2.25 2.1v.09C15.583 5.336 14.468 5.502 13.288 5.55M5.25 5.653c0-.855.582-1.572 1.359-1.745C7.086 3.728 7.66 3.5 8.25 3.5h7.5c.59 0 1.164.228 1.631.408.777.173 1.359.89 1.359 1.745v.488c0 .855-.582 1.572-1.359 1.745C16.914 8.272 16.34 8.5 15.75 8.5h-7.5c-.59 0-1.164-.228-1.631-.408C5.832 7.918 5.25 7.195 5.25 6.34V5.653z" })
  )
);

const PencilIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: "1.5", stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" })
  )
);

const PaperAirplaneIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" })
  )
);

const XMarkIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: "1.5", stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M6 18L18 6M6 6l12 12" })
  )
);

const CubeTransparentIcon = ({ className }) => (
    React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: className },
        React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9" })
    )
);

const ChartPieIcon = ({ className }) => (
    React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: className },
        React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M10.5 6a7.5 7.5 0 107.5 7.5h-7.5V6z" }),
        React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M13.5 10.5H21A7.5 7.5 0 0013.5 3v7.5z" })
    )
);

const ChatBubbleBottomCenterTextIcon = ({ className }) => ( // Used for Forum
    React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: className },
        React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M8.058 12.396c.15-.439.06-.933-.26-1.292L3.92 7.23C3.06 6.368 3.51 5 4.77 5h14.46c1.26 0 1.71 1.368.85 2.23l-3.878 3.875c-.32.36-.41.852-.26 1.292m0 0l2.904 8.712c.18.54-.228 1.092-.832 1.092H5.988c-.604 0-1.012-.552-.832-1.092L8.058 12.396zM12 10.5h.008v.008H12v-.008zm0 3h.008v.008H12v-.008zm0 3h.008v.008H12v-.008z" }) // Replaced SVG content to better match a forum icon
    )
);

const CreditCardIcon = ({ className }) => (
    React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: className },
        React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h6m3-5.25H21m-9 5.25h5.25M6 18a2.25 2.25 0 002.25 2.25h3.75a2.25 2.25 0 002.25-2.25V15a2.25 2.25 0 00-2.25-2.25H8.25A2.25 2.25 0 006 15v3z" })
    )
);

const UserCircleIcon = ({ className }) => (
    React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: className },
        React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z" })
    )
);

const TagIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z" }),
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M6 6h.008v.008H6V6z" })
  )
);

const PhotoIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" })
  )
);

const ChartBarIcon = ({ className }) => ( // Defined, though AnalyticsPage is removed
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z" })
  )
);

const BanknotesIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v15c0 .621-.504 1.125-1.125 1.125h-15A1.125 1.125 0 012.25 20.25v-15C2.25 4.504 3.004 3.75 3.75 3.75h15z" })
  )
);

const ArrowPathIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" })
  )
);

const CogIcon = ({ className }) => ( // Defined, though not used by active pages
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M4.5 12a7.5 7.5 0 0015 0m-15 0a7.5 7.5 0 1115 0m-15 0H3m18 0h-1.5m-15.036-7.026A7.5 7.5 0 004.5 12H3m18 0h-1.5m-15.036 7.026A7.5 7.5 0 014.5 12H3m18 0h-1.5m0 0A7.5 7.5 0 0012 4.5v15a7.5 7.5 0 007.5-7.5z" })
  )
);

const UserPlusIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M19 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zM4 19.235v-.11a6.375 6.375 0 0112.75 0v.109A12.318 12.318 0 0110.5 21a12.318 12.318 0 01-6.5-1.766z" })
  )
);

const ArrowLeftOnRectangleIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9" })
  )
);

const CheckCircleIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" })
  )
);

const XCircleIcon = ({ className }) => (
  React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: className },
    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" })
  )
);


// Content from components/Modal.tsx
const Modal = ({ isOpen, onClose, title, children }) => {
  if (!isOpen) return null;

  return (
    React.createElement('div', { className: "fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 p-4" },
      React.createElement('div', { className: "bg-white rounded-lg shadow-xl p-6 w-full max-w-md transform transition-all" },
        React.createElement('div', { className: "flex items-center justify-between mb-4" },
          React.createElement('h3', { className: "text-xl font-semibold text-condo-dark-text" }, title),
          React.createElement('button', {
            onClick: onClose,
            className: "text-slate-500 hover:text-slate-700 transition-colors",
            'aria-label': "Chiudi modale"
          }, React.createElement(XMarkIcon, { className: "w-6 h-6" }))
        ),
        React.createElement('div', null, children)
      )
    )
  );
};

// Content from components/LoadingSpinner.tsx
const LoadingSpinner = ({ size = 'md', text }) => {
  const sizeClasses = {
    sm: 'w-6 h-6 border-2',
    md: 'w-10 h-10 border-4',
    lg: 'w-16 h-16 border-4',
  };

  return (
    React.createElement('div', { className: "flex flex-col items-center justify-center py-4" },
      React.createElement('div', {
        className: `animate-spin rounded-full ${sizeClasses[size]} border-condo-primary border-t-transparent`
      }),
      text && React.createElement('p', { className: "mt-2 text-sm text-condo-dark-text" }, text)
    )
  );
};

// Content from pages/DashboardPage.tsx
const DashboardCard = ({ title, description, linkTo, icon, bgColor, textColor }) => (
  React.createElement(Link, { to: linkTo, className: `block p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300 ${bgColor} ${textColor}` },
    React.createElement('div', { className: "flex items-center mb-3" },
      React.cloneElement(icon, { className: "w-8 h-8 mr-3" }),
      React.createElement('h3', { className: "text-xl font-semibold" }, title)
    ),
    React.createElement('p', { className: "text-sm opacity-90" }, description)
  )
);

const DashboardPage = () => {
  const cards = [
    { title: "Avvisi Recenti", description: "Leggi gli ultimi avvisi e comunicazioni.", linkTo: "/avvisi", icon: React.createElement(BellIcon), bgColor: "bg-sky-500", textColor: "text-white" },
    { title: "Documenti Utili", description: "Accedi a regolamenti, verbali e altri documenti.", linkTo: "/documenti", icon: React.createElement(DocumentTextIcon), bgColor: "bg-emerald-500", textColor: "text-white" },
    { title: "Segnala un Problema", description: "Invia una segnalazione per guasti o manutenzioni.", linkTo: "/segnalazioni", icon: React.createElement(WrenchScrewdriverIcon), bgColor: "bg-amber-500", textColor: "text-condo-dark-text" },
    { title: "Prenota Spazi Comuni", description: "Verifica disponibilità e prenota sale o attrezzature.", linkTo: "/prenotazioni", icon: React.createElement(CalendarDaysIcon), bgColor: "bg-indigo-500", textColor: "text-white" },
    { title: "Contatti di Emergenza", description: "Trova numeri utili per amministrazione e servizi.", linkTo: "/contatti", icon: React.createElement(UsersIcon), bgColor: "bg-rose-500", textColor: "text-white" },
  ];

  return (
    React.createElement('div', { className: "animate-fadeIn" },
      React.createElement('h2', { className: "text-3xl font-bold text-condo-primary mb-8" }, "Bacheca Condominiale"),
      React.createElement('p', { className: "text-lg text-condo-text mb-10" },
        "Benvenuto nell'area riservata del tuo condominio. Qui puoi trovare tutte le informazioni e i servizi utili."
      ),
      React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" },
        cards.map(card => React.createElement(DashboardCard, { key: card.title, ...card }))
      )
    )
  );
};

// Content from pages/AnnouncementsPage.tsx
const AnnouncementsPage = () => {
  const ANNOUNCEMENTS_KEY = 'condo_announcements';
  const [announcements, setAnnouncements] = useState([]);
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [currentAnnouncement, setCurrentAnnouncement] = useState({});
  const [editingId, setEditingId] = useState(null);

  const loadAnnouncements = useCallback(() => {
    const storedAnnouncements = getItem(ANNOUNCEMENTS_KEY);
    if (storedAnnouncements) {
      setAnnouncements(storedAnnouncements.sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()));
    }
  }, []);

  useEffect(() => {
    loadAnnouncements();
  }, [loadAnnouncements]);

  const handleSave = () => {
    if (!currentAnnouncement.title || !currentAnnouncement.content) {
      alert("Titolo e contenuto sono obbligatori.");
      return;
    }

    let updatedAnnouncements;
    if (editingId) {
      updatedAnnouncements = announcements.map(ann => 
        ann.id === editingId ? { ...ann, ...currentAnnouncement, date: new Date().toISOString() } : ann
      );
    } else {
      const newAnnouncement = {
        id: Date.now().toString(),
        title: currentAnnouncement.title,
        content: currentAnnouncement.content,
        date: new Date().toISOString(),
      };
      updatedAnnouncements = [newAnnouncement, ...announcements];
    }
    
    setAnnouncements(updatedAnnouncements.sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()));
    setItem(ANNOUNCEMENTS_KEY, updatedAnnouncements);
    setIsModalOpen(false);
    setCurrentAnnouncement({});
    setEditingId(null);
  };

  const openAddModal = () => {
    setCurrentAnnouncement({ title: '', content: '' });
    setEditingId(null);
    setIsModalOpen(true);
  };

  const openEditModal = (announcement) => {
    setCurrentAnnouncement({ ...announcement });
    setEditingId(announcement.id);
    setIsModalOpen(true);
  };

  const handleDelete = (id) => {
    if (window.confirm("Sei sicuro di voler eliminare questo avviso?")) {
      const updatedAnnouncements = announcements.filter(ann => ann.id !== id);
      setAnnouncements(updatedAnnouncements);
      setItem(ANNOUNCEMENTS_KEY, updatedAnnouncements);
    }
  };

  return (
    React.createElement('div', { className: "container mx-auto p-4" },
      React.createElement('div', { className: "flex justify-between items-center mb-6" },
        React.createElement('h2', { className: "text-3xl font-bold text-condo-primary" }, "Avvisi"),
        React.createElement('button', {
          onClick: openAddModal,
          className: "bg-condo-primary hover:bg-condo-primary-dark text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition duration-300 flex items-center"
        }, React.createElement(PlusIcon, { className: "w-5 h-5 mr-2" }), "Nuovo Avviso")
      ),
      announcements.length === 0 ? (
        React.createElement('p', { className: "text-slate-600 text-center py-10" }, "Nessun avviso presente al momento.")
      ) : (
        React.createElement('div', { className: "space-y-4" },
          announcements.map((ann) => (
            React.createElement('div', { key: ann.id, className: "bg-white p-6 rounded-lg shadow-lg border border-slate-200" },
              React.createElement('div', { className: "flex justify-between items-start" },
                React.createElement('div', null,
                  React.createElement('h3', { className: "text-xl font-semibold text-condo-dark-text mb-1" }, ann.title),
                  React.createElement('p', { className: "text-sm text-slate-500 mb-3" }, `Pubblicato il: ${new Date(ann.date).toLocaleDateString('it-IT', { year: 'numeric', month: 'long', day: 'numeric' })}`)
                ),
                React.createElement('div', { className: "flex space-x-2" },
                  React.createElement('button', { onClick: () => openEditModal(ann), className: "text-sky-600 hover:text-sky-800", title: "Modifica Avviso" },
                    React.createElement(PencilIcon, { className: "w-5 h-5" })
                  ),
                  React.createElement('button', { onClick: () => handleDelete(ann.id), className: "text-red-500 hover:text-red-700", title: "Elimina Avviso" },
                    React.createElement(TrashIcon, { className: "w-5 h-5" })
                  )
                )
              ),
              React.createElement('p', { className: "text-slate-700 whitespace-pre-wrap" }, ann.content)
            )
          ))
        )
      ),
      React.createElement(Modal, { isOpen: isModalOpen, onClose: () => { setIsModalOpen(false); setCurrentAnnouncement({}); setEditingId(null); }, title: editingId ? "Modifica Avviso" : "Nuovo Avviso" },
        React.createElement('div', { className: "space-y-4" },
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "title", className: "block text-sm font-medium text-slate-700 mb-1" }, "Titolo"),
            React.createElement('input', {
              type: "text",
              id: "title",
              value: currentAnnouncement.title || '',
              onChange: (e) => setCurrentAnnouncement({ ...currentAnnouncement, title: e.target.value }),
              className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
            })
          ),
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "content", className: "block text-sm font-medium text-slate-700 mb-1" }, "Contenuto"),
            React.createElement('textarea', {
              id: "content",
              value: currentAnnouncement.content || '',
              onChange: (e) => setCurrentAnnouncement({ ...currentAnnouncement, content: e.target.value }),
              rows: 5,
              className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
            })
          ),
          React.createElement('div', { className: "flex justify-end space-x-3" },
            React.createElement('button', {
              onClick: () => { setIsModalOpen(false); setCurrentAnnouncement({}); setEditingId(null); },
              className: "px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-md border border-slate-300 transition"
            }, "Annulla"),
            React.createElement('button', {
              onClick: handleSave,
              className: "px-4 py-2 text-sm font-medium text-white bg-condo-primary hover:bg-condo-primary-dark rounded-md shadow-sm transition"
            }, editingId ? "Salva Modifiche" : "Pubblica Avviso")
          )
        )
      )
    )
  );
};

// Content from pages/DocumentsPage.tsx
const DocumentsPage = () => {
  const DOCUMENTS_KEY = 'condo_documents';
  const [documents, setDocuments] = useState([]);
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [currentDocument, setCurrentDocument] = useState({ name: '', type: '', tags: [] });
  const [tagsInput, setTagsInput] = useState('');

  const loadDocuments = useCallback(() => {
    const storedDocuments = getItem(DOCUMENTS_KEY);
    if (storedDocuments) {
      setDocuments(storedDocuments.sort((a,b) => new Date(b.uploadDate).getTime() - new Date(a.uploadDate).getTime()));
    } else {
      const exampleDocs = [
        { id: '1', name: 'Regolamento Condominiale 2024', type: 'PDF', uploadDate: new Date(2024,0,15).toISOString(), url: '#', tags: ['regolamento', 'ufficiale'] },
        { id: '2', name: 'Verbale Assemblea Gennaio 2024', type: 'PDF', uploadDate: new Date(2024,0,30).toISOString(), url: '#', tags: ['verbale', 'assemblea'] },
        { id: '3', name: 'Bilancio Consuntivo 2023', type: 'XLSX', uploadDate: new Date(2024,2,10).toISOString(), url: '#', tags: ['bilancio', 'finanze'] },
      ];
      setDocuments(exampleDocs);
      setItem(DOCUMENTS_KEY, exampleDocs);
    }
  }, []);

  useEffect(() => {
    loadDocuments();
  }, [loadDocuments]);

  const handleSave = () => {
    if (!currentDocument.name || !currentDocument.type) {
      alert("Nome del documento e tipo sono obbligatori.");
      return;
    }
    const tagsArray = tagsInput.split(',').map(tag => tag.trim()).filter(tag => tag !== '');
    const newDocument = {
      id: Date.now().toString(),
      name: currentDocument.name,
      type: currentDocument.type,
      tags: tagsArray,
      uploadDate: new Date().toISOString(),
      url: '#' 
    };
    const updatedDocuments = [newDocument, ...documents].sort((a,b) => new Date(b.uploadDate).getTime() - new Date(a.uploadDate).getTime());
    setDocuments(updatedDocuments);
    setItem(DOCUMENTS_KEY, updatedDocuments);
    setIsModalOpen(false);
    setCurrentDocument({ name: '', type: '', tags: [] });
    setTagsInput('');
  };
  
  const handleDelete = (id) => {
    if (window.confirm("Sei sicuro di voler eliminare questo documento?")) {
      const updatedDocuments = documents.filter(doc => doc.id !== id);
      setDocuments(updatedDocuments);
      setItem(DOCUMENTS_KEY, updatedDocuments);
    }
  };
  
  const openAddModal = () => {
    setCurrentDocument({ name: '', type: '', tags: [] });
    setTagsInput('');
    setIsModalOpen(true);
  }

  return (
    React.createElement('div', { className: "container mx-auto p-4 animate-fadeIn" },
      React.createElement('div', { className: "flex justify-between items-center mb-6" },
        React.createElement('h2', { className: "text-3xl font-bold text-condo-primary" }, "Documenti Condominiali"),
        React.createElement('button', {
          onClick: openAddModal,
          className: "bg-condo-primary hover:bg-condo-primary-dark text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition duration-300 flex items-center"
        }, React.createElement(PlusIcon, { className: "w-5 h-5 mr-2" }), "Aggiungi Documento")
      ),
      documents.length === 0 ? (
        React.createElement('p', { className: "text-slate-600 text-center py-10" }, "Nessun documento caricato.")
      ) : (
        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" },
          documents.map((doc) => (
            React.createElement('div', { key: doc.id, className: "bg-white p-5 rounded-lg shadow-lg border border-slate-200 flex flex-col justify-between hover:shadow-xl transition-shadow" },
              React.createElement('div', null,
                React.createElement('div', { className: "flex items-center text-condo-secondary mb-3" },
                  React.createElement(DocumentTextIcon, { className: "w-8 h-8 mr-3"}),
                  React.createElement('h3', { className: "text-lg font-semibold text-condo-dark-text truncate", title: doc.name }, doc.name)
                ),
                React.createElement('p', { className: "text-sm text-slate-600 mb-1" }, "Tipo: ", React.createElement('span', {className: "font-medium"}, doc.type)),
                React.createElement('p', { className: "text-xs text-slate-500 mb-3" }, `Caricato il: ${new Date(doc.uploadDate).toLocaleDateString('it-IT')}`),
                doc.tags && doc.tags.length > 0 && (
                  React.createElement('div', { className: "mb-3" },
                    React.createElement('span', { className: "text-xs text-slate-500 flex items-center" }, React.createElement(TagIcon, {className: "w-4 h-4 mr-1 text-slate-400"}), " Tags:"),
                    React.createElement('div', { className: "flex flex-wrap gap-1 mt-1" },
                      doc.tags.map(tag => (
                        React.createElement('span', { key: tag, className: "px-2 py-0.5 text-xs bg-sky-100 text-sky-700 rounded-full" }, tag)
                      ))
                    )
                  )
                )
              ),
              React.createElement('div', { className: "flex justify-between items-center mt-4" },
                React.createElement('a', { 
                  href: doc.url || '#', 
                  target: "_blank", 
                  rel: "noopener noreferrer", 
                  className: "text-sm text-condo-primary hover:underline disabled:opacity-50",
                  onClick: (e) => { if (!doc.url || doc.url === '#') { e.preventDefault(); alert("Nessun file allegato (simulazione).");} }
                }, "Visualizza/Scarica"),
                React.createElement('button', { onClick: () => handleDelete(doc.id), className: "text-red-500 hover:text-red-700", title: "Elimina Documento" },
                  React.createElement(TrashIcon, { className: "w-5 h-5" })
                )
              )
            )
          ))
        )
      ),
      React.createElement(Modal, { isOpen: isModalOpen, onClose: () => setIsModalOpen(false), title: "Aggiungi Nuovo Documento" },
        React.createElement('div', { className: "space-y-4" },
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "docName", className: "block text-sm font-medium text-slate-700 mb-1" }, "Nome Documento"),
            React.createElement('input', {
              type: "text",
              id: "docName",
              value: currentDocument.name || '',
              onChange: (e) => setCurrentDocument({ ...currentDocument, name: e.target.value }),
              className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
              placeholder: "Es. Verbale Assemblea Aprile 2024"
            })
          ),
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "docType", className: "block text-sm font-medium text-slate-700 mb-1" }, "Tipo Documento"),
            React.createElement('input', {
              type: "text",
              id: "docType",
              value: currentDocument.type || '',
              onChange: (e) => setCurrentDocument({ ...currentDocument, type: e.target.value }),
              className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
              placeholder: "Es. PDF, Regolamento, Fattura"
            })
          ),
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "docTags", className: "block text-sm font-medium text-slate-700 mb-1" }, "Tags (separati da virgola)"),
            React.createElement('input', {
              type: "text",
              id: "docTags",
              value: tagsInput,
              onChange: (e) => setTagsInput(e.target.value),
              className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
              placeholder: "Es. importante, verbale, bilancio"
            })
          ),
          React.createElement('p', { className: "text-xs text-slate-500" }, "Nota: La funzionalità di upload file è simulata. Verrà salvato solo il riferimento al documento."),
          React.createElement('div', { className: "flex justify-end space-x-3" },
             React.createElement('button', {
              onClick: () => { setIsModalOpen(false); setCurrentDocument({}); setTagsInput(''); },
              className: "px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-md border border-slate-300 transition"
            }, "Annulla"),
            React.createElement('button', {
              onClick: handleSave,
              className: "px-4 py-2 text-sm font-medium text-white bg-condo-primary hover:bg-condo-primary-dark rounded-md shadow-sm transition"
            }, "Aggiungi Documento")
          )
        )
      )
    )
  );
};

// Content from pages/IssuesPage.tsx
const IssuesPage = () => {
  const ISSUES_KEY = 'condo_issues';
  const USER_PROFILE_KEY = 'condo_user_profile';

  const initialIssueState = {
    description: '',
    location: '',
    locationDetails: '',
    photoUrlPlaceholder: '',
    urgency: 'Media',
    priority: 'Media',
    status: IssueStatus.APERTO,
    assignedVendor: '',
    resolutionNotes: ''
  };
  const [issues, setIssues] = useState([]);
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [currentIssue, setCurrentIssue] = useState(initialIssueState);
  const [editingId, setEditingId] = useState(null);
  
  const [currentUserProfile, setCurrentUserProfile] = useState(null);
   useEffect(() => {
    const profile = getItem(USER_PROFILE_KEY);
    setCurrentUserProfile(profile);
  }, []);
  const isAdmin = currentUserProfile?.isAdmin || false;


  const loadIssues = useCallback(() => {
    const storedIssues = getItem(ISSUES_KEY);
    if (storedIssues) {
      setIssues(storedIssues.sort((a,b) => new Date(b.reportedDate).getTime() - new Date(a.reportedDate).getTime()));
    } else {
      const exampleIssues = [
        { id: '1', description: 'Luce scale terzo piano non funzionante', location: 'Blocco A, Scale', reportedDate: new Date(2024, 5, 1).toISOString(), status: IssueStatus.APERTO, urgency: 'Media', priority: 'Media', locationDetails: 'Vicino appartamento 3B' },
        { id: '2', description: 'Perdita acqua dal soffitto garage', location: 'Garage, posto auto 12', reportedDate: new Date(2024, 5, 3).toISOString(), status: IssueStatus.IN_ELABORAZIONE, urgency: 'Alta', priority: 'Alta', assignedVendor: 'Idraulico Rossi', photoUrlPlaceholder: 'Foto della perdita disponibile' },
        { id: '3', description: 'Ascensore bloccato al piano terra', location: 'Blocco B, Ascensore', reportedDate: new Date(2024, 4, 20).toISOString(), status: IssueStatus.RISOLTO, urgency: 'Critica', priority: 'Critica', resolutionNotes: 'Riparato da tecnico ascensori il 21/04.', assignedVendor: 'TecnoLift Spa' },
      ];
      setIssues(exampleIssues);
      setItem(ISSUES_KEY, exampleIssues);
    }
  }, []);

  useEffect(() => {
    loadIssues();
  }, [loadIssues]);

  const handleSave = () => {
    if (!currentIssue.description || !currentIssue.location || !currentIssue.urgency) {
      alert("Descrizione, luogo e urgenza segnalata sono obbligatori.");
      return;
    }

    let updatedIssues;
    if (editingId) {
      updatedIssues = issues.map(iss => 
        iss.id === editingId ? { ...iss, ...currentIssue } : iss
      );
    } else {
      const newIssue = {
        id: Date.now().toString(),
        reportedDate: new Date().toISOString(),
        ...initialIssueState, 
        ...currentIssue 
      };
      updatedIssues = [newIssue, ...issues];
    }
    
    updatedIssues.sort((a,b) => new Date(b.reportedDate).getTime() - new Date(a.reportedDate).getTime());
    setIssues(updatedIssues);
    setItem(ISSUES_KEY, updatedIssues);
    setIsModalOpen(false);
    setCurrentIssue(initialIssueState);
    setEditingId(null);
  };
  
  const openAddModal = () => {
    setCurrentIssue(initialIssueState);
    setEditingId(null);
    setIsModalOpen(true);
  };

  const openEditModal = (issue) => {
    setCurrentIssue({ ...issue });
    setEditingId(issue.id);
    setIsModalOpen(true);
  };

  const handleDelete = (id) => {
    // Basic check for demo. In real app, reportedBy should be stored and checked.
    // if (!isAdmin && !issues.find(iss => iss.id === id)?.description.includes(currentUserProfile?.name.split(' ')[0])) { 
    //    alert("Non puoi eliminare questa segnalazione."); return; 
    // }
    if (window.confirm("Sei sicuro di voler eliminare questa segnalazione?")) {
      const updatedIssues = issues.filter(iss => iss.id !== id);
      setIssues(updatedIssues);
      setItem(ISSUES_KEY, updatedIssues);
    }
  };
  
  const getStatusColor = (status) => {
    switch (status) {
      case IssueStatus.APERTO: return 'bg-red-100 text-red-700';
      case IssueStatus.IN_ELABORAZIONE: return 'bg-yellow-100 text-yellow-700';
      case IssueStatus.RISOLTO: return 'bg-green-100 text-green-700';
      case IssueStatus.CHIUSO: return 'bg-slate-100 text-slate-700';
      default: return 'bg-slate-100 text-slate-700';
    }
  };

  const getUrgencyColor = (urgency) => {
    if (!urgency) return 'text-slate-600';
    switch (urgency) {
      case 'Bassa': return 'text-green-600';
      case 'Media': return 'text-yellow-600';
      case 'Alta': return 'text-orange-600';
      case 'Critica': return 'text-red-600';
      default: return 'text-slate-600';
    }
  };

  const urgencyLevels = ['Bassa', 'Media', 'Alta', 'Critica'];

  return (
    React.createElement('div', { className: "container mx-auto p-4 animate-fadeIn" },
      React.createElement('div', { className: "flex justify-between items-center mb-6" },
        React.createElement('h2', { className: "text-3xl font-bold text-condo-primary" }, "Segnalazioni Problemi"),
        React.createElement('button', {
          onClick: openAddModal,
          className: "bg-condo-primary hover:bg-condo-primary-dark text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition duration-300 flex items-center"
        }, React.createElement(PlusIcon, { className: "w-5 h-5 mr-2"}), "Nuova Segnalazione")
      ),
      issues.length === 0 ? (
        React.createElement('p', { className: "text-slate-600 text-center py-10" }, "Nessuna segnalazione presente.")
      ) : (
        React.createElement('div', { className: "space-y-4" },
          issues.map((iss) => (
            React.createElement('div', { key: iss.id, className: "bg-white p-5 rounded-lg shadow-lg border border-slate-200 hover:shadow-xl transition-shadow" },
              React.createElement('div', { className: "flex justify-between items-start mb-2" },
                React.createElement('h3', { className: "text-lg font-semibold text-condo-dark-text" }, iss.description),
                React.createElement('div', { className: "flex space-x-2" },
                  React.createElement('button', { onClick: () => openEditModal(iss), className: "text-sky-600 hover:text-sky-800", title: "Modifica Segnalazione" },
                    React.createElement(PencilIcon, { className: "w-5 h-5" })
                  ),
                  React.createElement('button', { onClick: () => handleDelete(iss.id), className: "text-red-500 hover:text-red-700", title: "Elimina Segnalazione" },
                    React.createElement(TrashIcon, { className: "w-5 h-5" })
                  )
                )
              ),
              React.createElement('p', { className: "text-sm text-slate-600" }, React.createElement('span', {className:"font-semibold"}, "Luogo:"), ` ${iss.location} ${iss.locationDetails ? `(${iss.locationDetails})` : ''}`),
              React.createElement('p', { className: "text-sm text-slate-600" }, React.createElement('span', {className:"font-semibold"}, "Data Segnalazione:"), ` ${new Date(iss.reportedDate).toLocaleDateString('it-IT', { day: '2-digit', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit' })}`),
              React.createElement('p', { className: "text-sm" }, React.createElement('span', {className:"font-semibold"}, "Urgenza Segnalata:"), React.createElement('span', {className: `${getUrgencyColor(iss.urgency)} font-medium`}, ` ${iss.urgency}`)),
              iss.priority && React.createElement('p', { className: "text-sm" }, React.createElement('span', {className:"font-semibold"}, "Priorità Admin:"), React.createElement('span', {className: `${getUrgencyColor(iss.priority)} font-medium`}, ` ${iss.priority}`)),
              iss.photoUrlPlaceholder && React.createElement('p', { className: "text-sm text-slate-600 flex items-center" }, React.createElement(PhotoIcon, {className:"w-4 h-4 mr-1 text-slate-500"}), React.createElement('span', {className:"font-semibold"}, "Foto:"), ` ${iss.photoUrlPlaceholder}`),
              iss.assignedVendor && React.createElement('p', { className: "text-sm text-slate-600" }, React.createElement('span', {className:"font-semibold"}, "Fornitore Assegnato:"), ` ${iss.assignedVendor}`),
              React.createElement('div', { className: "mt-3 flex justify-between items-center" },
                React.createElement('span', { className: `px-3 py-1 text-xs font-semibold rounded-full ${getStatusColor(iss.status)}` },
                  iss.status
                ),
                iss.status === IssueStatus.RISOLTO && iss.resolutionNotes && React.createElement('p', {className: "text-xs text-slate-500 italic mt-1"}, `Nota: ${iss.resolutionNotes}`)
              )
            )
          ))
        )
      ),
      React.createElement(Modal, { isOpen: isModalOpen, onClose: () => { setIsModalOpen(false); setCurrentIssue(initialIssueState); setEditingId(null); }, title: editingId ? "Modifica Segnalazione" : "Nuova Segnalazione" },
        React.createElement('div', { className: "space-y-4 max-h-[70vh] overflow-y-auto pr-2" },
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "issueDesc", className: "block text-sm font-medium text-slate-700 mb-1" }, "Descrizione Problema*"),
            React.createElement('textarea', {
              id: "issueDesc",
              rows: 3,
              value: currentIssue.description || '',
              onChange: (e) => setCurrentIssue({ ...currentIssue, description: e.target.value }),
              className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
              required: true
            })
          ),
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "issueLocation", className: "block text-sm font-medium text-slate-700 mb-1" }, "Luogo/Area*"),
            React.createElement('input', {
              type: "text",
              id: "issueLocation",
              value: currentIssue.location || '',
              onChange: (e) => setCurrentIssue({ ...currentIssue, location: e.target.value }),
              className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
              placeholder: "Es. Ascensore Blocco A",
              required: true
            })
          ),
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "issueLocationDetails", className: "block text-sm font-medium text-slate-700 mb-1" }, "Dettagli Posizione"),
            React.createElement('input', {
              type: "text",
              id: "issueLocationDetails",
              value: currentIssue.locationDetails || '',
              onChange: (e) => setCurrentIssue({ ...currentIssue, locationDetails: e.target.value }),
              className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
              placeholder: "Es. Vicino porta contatori, Piano 3 Scala B"
            })
          ),
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "issuePhoto", className: "block text-sm font-medium text-slate-700 mb-1" }, "Foto (URL o Descrizione)"),
            React.createElement('input', {
              type: "text",
              id: "issuePhoto",
              value: currentIssue.photoUrlPlaceholder || '',
              onChange: (e) => setCurrentIssue({ ...currentIssue, photoUrlPlaceholder: e.target.value }),
              className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
              placeholder: "Link a foto o breve descrizione"
            }),
            React.createElement('p', {className: "text-xs text-slate-500 mt-1"}, "Nota: Caricamento file non supportato, inserire un link o descrizione.")
          ),
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "issueUrgency", className: "block text-sm font-medium text-slate-700 mb-1" }, "Urgenza Segnalata*"),
            React.createElement('select', {
              id: "issueUrgency",
              value: currentIssue.urgency || 'Media',
              onChange: (e) => setCurrentIssue({ ...currentIssue, urgency: e.target.value }),
              className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
            },
              urgencyLevels.map(level => React.createElement('option', { key: level, value: level }, level))
            )
          ),
          
          (isAdmin && editingId) && ( 
            React.createElement(React.Fragment, null,
              React.createElement('hr', {className: "my-3"}),
              React.createElement('h4', { className: "text-md font-semibold text-condo-primary mb-2" }, "Gestione Amministratore"),
              React.createElement('div', null,
                React.createElement('label', { htmlFor: "issueStatus", className: "block text-sm font-medium text-slate-700 mb-1" }, "Stato"),
                React.createElement('select', {
                  id: "issueStatus",
                  value: currentIssue.status || '',
                  onChange: (e) => setCurrentIssue({ ...currentIssue, status: e.target.value }),
                  className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
                },
                  Object.values(IssueStatus).map(status => (
                    React.createElement('option', { key: status, value: status }, status)
                  ))
                )
              ),
              React.createElement('div', null,
                React.createElement('label', { htmlFor: "issuePriority", className: "block text-sm font-medium text-slate-700 mb-1" }, "Priorità (Admin)"),
                React.createElement('select', {
                  id: "issuePriority",
                  value: currentIssue.priority || currentIssue.urgency || 'Media',
                  onChange: (e) => setCurrentIssue({ ...currentIssue, priority: e.target.value }),
                  className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
                },
                  urgencyLevels.map(level => React.createElement('option', { key: level, value: level }, level))
                )
              ),
              React.createElement('div', null,
                React.createElement('label', { htmlFor: "assignedVendor", className: "block text-sm font-medium text-slate-700 mb-1" }, "Fornitore Assegnato"),
                React.createElement('input', {
                  type: "text",
                  id: "assignedVendor",
                  value: currentIssue.assignedVendor || '',
                  onChange: (e) => setCurrentIssue({ ...currentIssue, assignedVendor: e.target.value }),
                  className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
                  placeholder: "Es. Idraulico Mario, Elettricista Srl"
                })
              ),
               React.createElement('div', null,
                React.createElement('label', { htmlFor: "resolutionNotes", className: "block text-sm font-medium text-slate-700 mb-1" }, "Note Risoluzione"),
                React.createElement('textarea', {
                  id: "resolutionNotes",
                  rows: 2,
                  value: currentIssue.resolutionNotes || '',
                  onChange: (e) => setCurrentIssue({ ...currentIssue, resolutionNotes: e.target.value }),
                  className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
                })
              )
            )
          ),
          React.createElement('div', { className: "flex justify-end space-x-3 pt-2" },
            React.createElement('button', {
                onClick: () => { setIsModalOpen(false); setCurrentIssue(initialIssueState); setEditingId(null); },
                className: "px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-md border border-slate-300 transition"
            }, "Annulla"),
            React.createElement('button', {
                onClick: handleSave,
                className: "px-4 py-2 text-sm font-medium text-white bg-condo-primary hover:bg-condo-primary-dark rounded-md shadow-sm transition"
            }, editingId ? "Salva Modifiche" : "Invia Segnalazione")
          )
        )
      )
    )
  );
};

// Content from pages/ReservationsPage.tsx
const ReservationsPage = () => {
  const RESERVATIONS_KEY = 'condo_reservations';
  const [reservations, setReservations] = useState([]);
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [currentReservation, setCurrentReservation] = useState({});

  const loadReservations = useCallback(() => {
    const storedReservations = getItem(RESERVATIONS_KEY);
    if (storedReservations) {
      setReservations(storedReservations.sort((a,b) => new Date(a.date + 'T' + a.time).getTime() - new Date(b.date + 'T' + b.time).getTime()));
    }
  }, []);

  useEffect(() => {
    loadReservations();
  }, [loadReservations]);

  const handleSave = () => {
    if (!currentReservation.amenity || !currentReservation.userName || !currentReservation.date || !currentReservation.time) {
      alert("Tutti i campi sono obbligatori per la prenotazione.");
      return;
    }
    const newReservation = {
      id: Date.now().toString(),
      amenity: currentReservation.amenity,
      userName: currentReservation.userName,
      date: currentReservation.date,
      time: currentReservation.time,
    };
    const updatedReservations = [...reservations, newReservation].sort((a,b) => new Date(a.date + 'T' + a.time).getTime() - new Date(b.date + 'T' + b.time).getTime());
    setReservations(updatedReservations);
    setItem(RESERVATIONS_KEY, updatedReservations);
    setIsModalOpen(false);
    setCurrentReservation({});
  };

  const handleDelete = (id) => {
    if (window.confirm("Sei sicuro di voler cancellare questa prenotazione?")) {
      const updatedReservations = reservations.filter(res => res.id !== id);
      setReservations(updatedReservations);
      setItem(RESERVATIONS_KEY, updatedReservations);
    }
  };
  
  const today = new Date().toISOString().split('T')[0];

  return (
    React.createElement('div', { className: "container mx-auto p-4" },
      React.createElement('div', { className: "flex justify-between items-center mb-6" },
        React.createElement('h2', { className: "text-3xl font-bold text-condo-primary" }, "Prenotazioni Aree Comuni"),
        React.createElement('button', {
          onClick: () => { setCurrentReservation({ date: today }); setIsModalOpen(true); },
          className: "bg-condo-primary hover:bg-condo-primary-dark text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition duration-300 flex items-center"
        }, React.createElement(PlusIcon, { className: "w-5 h-5 mr-2" }), "Nuova Prenotazione")
      ),
      reservations.length === 0 ? (
        React.createElement('p', { className: "text-slate-600 text-center py-10" }, "Nessuna prenotazione attiva.")
      ) : (
        React.createElement('div', { className: "space-y-4" },
          reservations.map((res) => (
            React.createElement('div', { key: res.id, className: "bg-white p-5 rounded-lg shadow-lg border border-slate-200" },
              React.createElement('div', { className: "flex items-center text-condo-secondary mb-2" },
                React.createElement(CalendarDaysIcon, { className: "w-6 h-6 mr-2"}),
                React.createElement('h3', { className: "text-lg font-semibold text-condo-dark-text" }, res.amenity)
              ),
              React.createElement('p', { className: "text-sm text-slate-700" }, "Prenotato da: ", React.createElement('span', {className: "font-medium"}, res.userName)),
              React.createElement('p', { className: "text-sm text-slate-700" }, "Data: ", React.createElement('span', {className: "font-medium"}, new Date(res.date).toLocaleDateString('it-IT', { year: 'numeric', month: 'long', day: 'numeric' }))),
              React.createElement('p', { className: "text-sm text-slate-700" }, "Ora: ", React.createElement('span', {className: "font-medium"}, res.time)),
              React.createElement('div', { className: "mt-3 text-right" },
                React.createElement('button', { onClick: () => handleDelete(res.id), className: "text-red-500 hover:text-red-700", title: "Cancella Prenotazione" },
                  React.createElement(TrashIcon, { className: "w-5 h-5" })
                )
              )
            )
          ))
        )
      ),
      React.createElement(Modal, { isOpen: isModalOpen, onClose: () => { setIsModalOpen(false); setCurrentReservation({});}, title: "Effettua Prenotazione" },
        React.createElement('div', { className: "space-y-4" },
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "resAmenity", className: "block text-sm font-medium text-slate-700 mb-1" }, "Area/Servizio"),
            React.createElement('input', {
              type: "text",
              id: "resAmenity",
              value: currentReservation.amenity || '',
              onChange: (e) => setCurrentReservation({ ...currentReservation, amenity: e.target.value }),
              className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
              placeholder: "Es. Sala Feste, Campo da Tennis"
            })
          ),
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "resUserName", className: "block text-sm font-medium text-slate-700 mb-1" }, "Nome Prenotante"),
            React.createElement('input', {
              type: "text",
              id: "resUserName",
              value: currentReservation.userName || '',
              onChange: (e) => setCurrentReservation({ ...currentReservation, userName: e.target.value }),
              className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
            })
          ),
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "resDate", className: "block text-sm font-medium text-slate-700 mb-1" }, "Data"),
            React.createElement('input', {
              type: "date",
              id: "resDate",
              value: currentReservation.date || today,
              min: today,
              onChange: (e) => setCurrentReservation({ ...currentReservation, date: e.target.value }),
              className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
            })
          ),
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "resTime", className: "block text-sm font-medium text-slate-700 mb-1" }, "Ora"),
            React.createElement('input', {
              type: "time",
              id: "resTime",
              value: currentReservation.time || '',
              onChange: (e) => setCurrentReservation({ ...currentReservation, time: e.target.value }),
              className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
            })
          ),
          React.createElement('div', { className: "flex justify-end space-x-3" },
            React.createElement('button', {
                onClick: () => { setIsModalOpen(false); setCurrentReservation({}); },
                className: "px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-md border border-slate-300 transition"
            }, "Annulla"),
            React.createElement('button', {
                onClick: handleSave,
                className: "px-4 py-2 text-sm font-medium text-white bg-condo-primary hover:bg-condo-primary-dark rounded-md shadow-sm transition"
            }, "Conferma Prenotazione")
          )
        )
      )
    )
  );
};

// Content from pages/ContactsPage.tsx
const ContactsPage = () => {
  const contactsData = [
    { id: '1', name: 'Mario Rossi', role: 'Amministratore Condominiale', phone: '012-3456789', email: 'amministratore@condominio.it' },
    { id: '2', name: 'Luigi Verdi', role: 'Portiere (Mattina)', phone: '333-1122334' },
    { id: '3', name: 'Giovanna Bianchi', role: 'Portiere (Pomeriggio)', phone: '333-4455667' },
    { id: '4', name: 'Pronto Intervento Idraulico H24', role: 'Idraulico Emergenze', phone: '800-123456' },
    { id: '5', name: 'Servizio Elettricisti Associati', role: 'Elettricista Emergenze', phone: '800-654321' },
    { id: '6', name: 'Manutenzione Ascensori S.r.l.', role: 'Assistenza Ascensori', phone: '02-9876543' },
  ];

  return (
    React.createElement('div', { className: "container mx-auto p-4" },
      React.createElement('div', { className: "flex items-center mb-8" },
        React.createElement(UsersIcon, { className: "w-10 h-10 text-condo-primary mr-3"}),
        React.createElement('h2', { className: "text-3xl font-bold text-condo-primary" }, "Contatti Utili")
      ),
      React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" },
        contactsData.map((contact) => (
          React.createElement('div', { key: contact.id, className: "bg-white p-6 rounded-lg shadow-lg border border-slate-200 hover:shadow-xl transition-shadow duration-300" },
            React.createElement('h3', { className: "text-xl font-semibold text-condo-dark-text mb-2" }, contact.name),
            React.createElement('p', { className: "text-md text-condo-secondary font-medium mb-3" }, contact.role),
            contact.phone && (
              React.createElement('p', { className: "text-sm text-slate-600 mb-1" },
                React.createElement('span', { className: "font-semibold" }, "Telefono: "), React.createElement('a', { href: `tel:${contact.phone}`, className: "text-condo-primary hover:underline" }, contact.phone)
              )
            ),
            contact.email && (
              React.createElement('p', { className: "text-sm text-slate-600" },
                React.createElement('span', { className: "font-semibold" }, "Email: "), React.createElement('a', { href: `mailto:${contact.email}`, className: "text-condo-primary hover:underline" }, contact.email)
              )
            )
          )
        ))
      ),
      React.createElement('div', { className: "mt-10 p-4 bg-sky-100 border border-sky-300 rounded-lg text-sky-700" },
        React.createElement('h4', { className: "font-semibold text-lg mb-2" }, "Numeri di Emergenza Nazionali"),
        React.createElement('ul', { className: "list-disc list-inside space-y-1" },
          React.createElement('li', null, "Polizia di Stato: ", React.createElement('span', {className: "font-bold"}, "113")),
          React.createElement('li', null, "Carabinieri: ", React.createElement('span', {className: "font-bold"}, "112")),
          React.createElement('li', null, "Vigili del Fuoco: ", React.createElement('span', {className: "font-bold"}, "115")),
          React.createElement('li', null, "Emergenza Sanitaria: ", React.createElement('span', {className: "font-bold"}, "118"))
        )
      )
    )
  );
};

// Content from pages/PackageNotificationsPage.tsx
const PackageNotificationsPage = () => {
  const PACKAGES_KEY = 'condo_package_notifications';
  const USER_PROFILE_KEY = 'condo_user_profile';

  const [packages, setPackages] = useState([]);
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [currentPackage, setCurrentPackage] = useState({});
  const [currentUserProfile, setCurrentUserProfile] = useState(null);

  useEffect(() => {
    const profile = getItem(USER_PROFILE_KEY);
    setCurrentUserProfile(profile);
  }, []);

  const isAdmin = currentUserProfile?.isAdmin || false;

  const loadPackages = useCallback(() => {
    const storedPackages = getItem(PACKAGES_KEY);
    if (storedPackages) {
      setPackages(storedPackages.sort((a, b) => new Date(b.receivedDate).getTime() - new Date(a.receivedDate).getTime()));
    } else {
      const examplePackages = [
        { id: '1', residentName: 'Fam. Rossi (Int. 5A)', courier: 'Amazon Logistics', trackingNumber: 'AMZ123456789', receivedDate: new Date(2024,5,10,10,30).toISOString(), notes: 'Pacco piccolo, lasciato in portineria', collected: false },
        { id: '2', residentName: 'Sig. Bianchi (Int. 12B)', courier: 'BRT Corriere Espresso', receivedDate: new Date(2024,5,9,15,0).toISOString(), collected: true, collectedDate: new Date(2024,5,9,17,0).toISOString() },
        { id: '3', residentName: 'Condominio (Amministratore)', courier: 'Poste Italiane', receivedDate: new Date(2024,5,11,9,0).toISOString(), notes: 'Raccomandata per amministrazione', collected: false },
      ];
      setPackages(examplePackages.sort((a, b) => new Date(b.receivedDate).getTime() - new Date(a.receivedDate).getTime()));
      setItem(PACKAGES_KEY, examplePackages);
    }
  }, []);

  useEffect(() => {
    loadPackages();
  }, [loadPackages]);

  const handleSave = () => {
    if (!isAdmin) return;
    if (!currentPackage.residentName || !currentPackage.courier) {
      alert("Nome residente e corriere sono obbligatori.");
      return;
    }
    const newPackage = {
      id: Date.now().toString(),
      residentName: currentPackage.residentName,
      courier: currentPackage.courier,
      trackingNumber: currentPackage.trackingNumber || '',
      notes: currentPackage.notes || '',
      receivedDate: currentPackage.receivedDate || new Date().toISOString(),
      collected: false,
    };
    const updatedPackages = [newPackage, ...packages].sort((a, b) => new Date(b.receivedDate).getTime() - new Date(a.receivedDate).getTime());
    setPackages(updatedPackages);
    setItem(PACKAGES_KEY, updatedPackages);
    setIsModalOpen(false);
    setCurrentPackage({});
  };

  const handleDelete = (id) => {
    if (!isAdmin) {
        alert("Solo gli amministratori possono eliminare le notifiche.");
        return;
    }
    if (window.confirm("Sei sicuro di voler eliminare questa notifica di pacco?")) {
      const updatedPackages = packages.filter(pkg => pkg.id !== id);
      setPackages(updatedPackages);
      setItem(PACKAGES_KEY, updatedPackages);
    }
  };

  const toggleCollected = (id) => {
    const updatedPackages = packages.map(pkg => {
      if (pkg.id === id) {
        return { ...pkg, collected: !pkg.collected, collectedDate: !pkg.collected ? new Date().toISOString() : undefined };
      }
      return pkg;
    });
    setPackages(updatedPackages.sort((a, b) => new Date(b.receivedDate).getTime() - new Date(a.receivedDate).getTime()));
    setItem(PACKAGES_KEY, updatedPackages);
  };
  
  const openAddModal = () => {
    if (!isAdmin) {
        alert("Solo gli amministratori possono aggiungere notifiche di pacchi.");
        return;
    }
    setCurrentPackage({ receivedDate: new Date().toISOString().slice(0,16) });
    setIsModalOpen(true);
  }

  return (
    React.createElement('div', { className: "container mx-auto p-4 animate-fadeIn" },
      React.createElement('div', { className: "flex justify-between items-center mb-6" },
        React.createElement('h2', { className: "text-3xl font-bold text-condo-primary flex items-center" }, 
          React.createElement(CubeTransparentIcon, { className: "w-8 h-8 mr-2"}), "Notifiche Consegna Pacchi"
        ),
        isAdmin && (
            React.createElement('button', {
              onClick: openAddModal,
              className: "bg-condo-primary hover:bg-condo-primary-dark text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition duration-300 flex items-center"
            }, React.createElement(PlusIcon, { className: "w-5 h-5 mr-2" }), "Aggiungi Notifica Pacco")
        )
      ),
      packages.length === 0 ? (
        React.createElement('p', { className: "text-slate-600 text-center py-10" }, "Nessuna notifica di pacco presente.")
      ) : (
        React.createElement('div', { className: "space-y-4" },
          packages.map((pkg) => (
            React.createElement('div', { key: pkg.id, className: `bg-white p-5 rounded-lg shadow-lg border ${pkg.collected ? 'border-green-300 opacity-70' : 'border-slate-200'} hover:shadow-xl transition-shadow`},
              React.createElement('div', { className: "flex justify-between items-start" },
                React.createElement('div', null,
                  React.createElement('h3', { className: `text-lg font-semibold ${pkg.collected ? 'text-slate-500 line-through' : 'text-condo-dark-text'}`}, pkg.residentName),
                  React.createElement('p', { className: `text-sm ${pkg.collected ? 'text-slate-400' : 'text-slate-600'}`}, "Corriere: ", React.createElement('span', {className: "font-medium"}, pkg.courier)),
                  pkg.trackingNumber && React.createElement('p', { className: `text-sm ${pkg.collected ? 'text-slate-400' : 'text-slate-600'}`}, "Tracciamento: ", pkg.trackingNumber)
                ),
                React.createElement('div', { className: "flex items-center space-x-2" },
                    React.createElement('button', { 
                        onClick: () => toggleCollected(pkg.id),
                        className: `px-3 py-1 text-xs font-semibold rounded-full transition-colors ${pkg.collected ? 'bg-green-500 text-white hover:bg-green-600' : 'bg-yellow-400 text-yellow-800 hover:bg-yellow-500'}`,
                        title: pkg.collected ? "Segna come NON ritirato" : "Segna come RITIRATO"
                    }, pkg.collected ? 'Ritirato' : 'Da Ritirare'),
                    isAdmin && (
                        React.createElement('button', { onClick: () => handleDelete(pkg.id), className: "text-red-500 hover:text-red-700", title: "Elimina Notifica" },
                            React.createElement(TrashIcon, { className: "w-5 h-5" })
                        )
                    )
                )
              ),
              React.createElement('p', { className: `text-xs ${pkg.collected ? 'text-slate-400' : 'text-slate-500'} mt-1`},
                `Ricevuto il: ${new Date(pkg.receivedDate).toLocaleString('it-IT', { day: '2-digit', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit' })}`
              ),
              pkg.notes && React.createElement('p', { className: `text-sm italic ${pkg.collected ? 'text-slate-400' : 'text-slate-600'} mt-2`}, "Note: ", pkg.notes),
              pkg.collected && pkg.collectedDate && (
                React.createElement('p', { className: "text-xs text-green-600 mt-1"},
                  `Ritirato il: ${new Date(pkg.collectedDate).toLocaleString('it-IT', { day: '2-digit', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit' })}`
                )
              )
            )
          ))
        )
      ),
      isAdmin && (
        React.createElement(Modal, { isOpen: isModalOpen, onClose: () => setIsModalOpen(false), title: "Aggiungi Notifica Pacco" },
          React.createElement('div', { className: "space-y-4" },
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "pkgResidentName", className: "block text-sm font-medium text-slate-700 mb-1" }, "Nome Residente/Interno*"),
              React.createElement('input', {
                type: "text", id: "pkgResidentName", value: currentPackage.residentName || '',
                onChange: (e) => setCurrentPackage({ ...currentPackage, residentName: e.target.value }),
                className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
                placeholder: "Es. Fam. Rossi (Int. 5A)"
              })
            ),
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "pkgCourier", className: "block text-sm font-medium text-slate-700 mb-1" }, "Corriere*"),
              React.createElement('input', {
                type: "text", id: "pkgCourier", value: currentPackage.courier || '',
                onChange: (e) => setCurrentPackage({ ...currentPackage, courier: e.target.value }),
                className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
                placeholder: "Es. Amazon, BRT, Poste Italiane"
              })
            ),
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "pkgTracking", className: "block text-sm font-medium text-slate-700 mb-1" }, "Numero di Tracciamento (Opzionale)"),
              React.createElement('input', {
                type: "text", id: "pkgTracking", value: currentPackage.trackingNumber || '',
                onChange: (e) => setCurrentPackage({ ...currentPackage, trackingNumber: e.target.value }),
                className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
              })
            ),
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "pkgReceivedDate", className: "block text-sm font-medium text-slate-700 mb-1" }, "Data e Ora Ricezione*"),
              React.createElement('input', {
                type: "datetime-local", id: "pkgReceivedDate", value: currentPackage.receivedDate || new Date().toISOString().slice(0,16),
                onChange: (e) => setCurrentPackage({ ...currentPackage, receivedDate: e.target.value }),
                className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
              })
            ),
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "pkgNotes", className: "block text-sm font-medium text-slate-700 mb-1" }, "Note (Opzionale)"),
              React.createElement('textarea', {
                id: "pkgNotes", rows: 2, value: currentPackage.notes || '',
                onChange: (e) => setCurrentPackage({ ...currentPackage, notes: e.target.value }),
                className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
                placeholder: "Es. Lasciato in portineria, pacco fragile..."
              })
            ),
            React.createElement('div', { className: "flex justify-end space-x-3" },
              React.createElement('button', { onClick: () => { setIsModalOpen(false); setCurrentPackage({}); }, className: "px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-md border border-slate-300 transition" }, "Annulla"),
              React.createElement('button', { onClick: handleSave, className: "px-4 py-2 text-sm font-medium text-white bg-condo-primary hover:bg-condo-primary-dark rounded-md shadow-sm transition" }, "Aggiungi Notifica")
            )
          )
        )
      )
    )
  );
};

// Content from pages/PollsPage.tsx
const PollsPage = () => {
  const POLLS_KEY = 'condo_polls';
  const VOTES_KEY_PREFIX = 'condo_poll_votes_';
  const USER_PROFILE_KEY = 'condo_user_profile';

  const [polls, setPolls] = useState([]);
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [currentPoll, setCurrentPoll] = useState({ options: [{ id: 'opt1', text: '' }, {id: 'opt2', text: ''}] });
  const [editingId, setEditingId] = useState(null);
  const [currentUserProfile, setCurrentUserProfile] = useState(null);

  useEffect(() => {
    const profile = getItem(USER_PROFILE_KEY);
    setCurrentUserProfile(profile);
  }, []);

  const isAdmin = currentUserProfile?.isAdmin || false;
  const currentUserName = currentUserProfile?.name || 'Utente Anonimo';
  const currentUserId = currentUserProfile?.id || 'anonymous_user';

  const loadPolls = useCallback(() => {
    const storedPolls = getItem(POLLS_KEY);
    if (storedPolls) {
      setPolls(storedPolls.map(p => ({...p, votes: p.votes || [], status: p.status || 'closed'})).sort((a, b) => new Date(b.createdDate).getTime() - new Date(a.createdDate).getTime()));
    } else {
      const examplePolls = [
        { id: 'poll1', question: 'Quale colore preferisci per le nuove tende dell\'atrio?', options: [{id: 'o1', text: 'Blu Notte'}, {id: 'o2', text: 'Grigio Perla'}, {id: 'o3', text: 'Beige Sabbia'}], createdDate: new Date(2024,4,15).toISOString(), createdBy: 'Amministratore', status: 'active', votes: [] },
        { id: 'poll2', question: 'Sei favorevole all\'installazione di un\'area giochi per bambini nel giardino comune?', options: [{id: 'o4', text: 'Sì, assolutamente'}, {id: 'o5', text: 'No, preferisco di no'}, {id: 'o6', text: 'Indifferente'}], createdDate: new Date(2024,5,1).toISOString(), createdBy: 'Amministratore', status: 'closed', endDate: new Date(2024,5,10).toISOString(), votes: [{userId: 'user123', optionId: 'o4'}, {userId: 'user456', optionId: 'o4'}, {userId: 'user789', optionId: 'o5'}] },
        { id: 'poll3', question: 'Dovremmo organizzare una pulizia straordinaria delle cantine questo mese?', options: [{id: 'o7', text: 'Sì'}, {id: 'o8', text: 'No'}], createdDate: new Date(2024,5,5).toISOString(), createdBy: 'Mario Rossi', status: 'proposed', proposedBy: 'Mario Rossi', votes: [] },
      ];
      setPolls(examplePolls.sort((a, b) => new Date(b.createdDate).getTime() - new Date(a.createdDate).getTime()));
      setItem(POLLS_KEY, examplePolls);
    }
  }, []);

  useEffect(() => {
    loadPolls();
  }, [loadPolls]);

  const handleOptionChange = (index, value) => {
    const options = [...(currentPoll.options || [])];
    options[index] = { ...options[index], id: options[index]?.id || `newOpt${Date.now()}`, text: value };
    setCurrentPoll({ ...currentPoll, options });
  };

  const addOption = () => {
    const options = [...(currentPoll.options || [])];
    options.push({ id: `opt${Date.now()}`, text: '' });
    setCurrentPoll({ ...currentPoll, options });
  };

  const removeOption = (index) => {
    if ((currentPoll.options?.length || 0) <= 2) {
        alert("Un sondaggio deve avere almeno due opzioni.");
        return;
    }
    const options = [...(currentPoll.options || [])];
    options.splice(index, 1);
    setCurrentPoll({ ...currentPoll, options });
  };

  const handleSave = () => {
    if (!currentPoll.question || (currentPoll.options?.length || 0) < 2 || currentPoll.options?.some(opt => !opt.text.trim())) {
      alert("Domanda e almeno due opzioni con testo sono obbligatori.");
      return;
    }

    let updatedPolls;
    if (editingId) {
      updatedPolls = polls.map(p => 
        p.id === editingId ? { ...p, ...currentPoll, status: currentPoll.status || p.status } : p
      );
    } else { 
      const newPoll = {
        id: Date.now().toString(),
        question: currentPoll.question,
        options: currentPoll.options.map(opt => ({...opt, id: opt.id || `opt${Math.random()}`})),
        createdDate: new Date().toISOString(),
        createdBy: currentUserName,
        status: isAdmin ? (currentPoll.status || 'active') : 'proposed',
        proposedBy: isAdmin ? undefined : currentUserName,
        votes: [],
        endDate: isAdmin ? currentPoll.endDate : undefined
      };
      updatedPolls = [newPoll, ...polls];
    }
    
    updatedPolls.sort((a, b) => new Date(b.createdDate).getTime() - new Date(a.createdDate).getTime());
    setPolls(updatedPolls);
    setItem(POLLS_KEY, updatedPolls);
    setIsModalOpen(false);
    setCurrentPoll({ options: [{ id: 'opt1', text: '' }, {id: 'opt2', text: ''}] });
    setEditingId(null);
  };
  
  const openModalForNew = () => {
    setCurrentPoll({ 
        question: '', 
        options: [{ id: `opt${Date.now()}`, text: '' }, { id: `opt${Date.now()+1}`, text: '' }], 
        status: isAdmin ? 'active' : 'proposed', 
        votes: [] 
    });
    setEditingId(null);
    setIsModalOpen(true);
  };
  
  const openEditModal = (poll) => { 
    if (!isAdmin) { return; } 
    setCurrentPoll({ ...poll });
    setEditingId(poll.id);
    setIsModalOpen(true);
  };

  const handleDelete = (id) => { 
    if (!isAdmin) { return; } 
    if (window.confirm("Sei sicuro di voler eliminare questo sondaggio?")) {
      const updatedPolls = polls.filter(p => p.id !== id);
      setPolls(updatedPolls);
      setItem(POLLS_KEY, updatedPolls);
    }
  };

  const handleApproveProposal = (pollId) => {
    if(!isAdmin) return;
    const updatedPolls = polls.map(p => p.id === pollId ? {...p, status: 'active'} : p);
    setPolls(updatedPolls);
    setItem(POLLS_KEY, updatedPolls);
  };

  const handleRejectProposal = (pollId) => { 
    if(!isAdmin) return;
     if (window.confirm("Sei sicuro di voler rigettare (eliminare) questo sondaggio proposto?")) {
        handleDelete(pollId);
     }
  };

  const handleVote = (pollId, optionId) => {
    const poll = polls.find(p => p.id === pollId);
    if (!poll || poll.status !== 'active') { 
      alert("Sondaggio non attivo o non trovato.");
      return;
    }
    
    const userVoteKey = `${VOTES_KEY_PREFIX}${pollId}_${currentUserId}`;
    if (getItem(userVoteKey)) {
      alert("Hai già votato a questo sondaggio.");
      return;
    }

    const updatedPolls = polls.map(p => {
      if (p.id === pollId) {
        const newVotes = [...(p.votes || []), { userId: currentUserId, optionId }];
        return { ...p, votes: newVotes };
      }
      return p;
    });
    setPolls(updatedPolls);
    setItem(POLLS_KEY, updatedPolls);
    setItem(userVoteKey, optionId);
  };
  
  const getUserVote = (pollId) => {
     const userVoteKey = `${VOTES_KEY_PREFIX}${pollId}_${currentUserId}`;
     return getItem(userVoteKey);
  }

  const getVoteCount = (poll, optionId) => {
    return poll.votes.filter(v => v.optionId === optionId).length;
  };

  const getTotalVotes = (poll) => {
    return poll.votes.length;
  };

  const getStatusLabelAndColor = (status) => {
    switch(status) {
      case 'active': return { label: 'Aperto', color: 'bg-green-100 text-green-700' };
      case 'closed': return { label: 'Chiuso', color: 'bg-slate-100 text-slate-700' };
      case 'proposed': return { label: 'Proposto (In Approvazione)', color: 'bg-yellow-100 text-yellow-700' };
      default: return { label: 'Sconosciuto', color: 'bg-gray-100 text-gray-700' };
    }
  };
  
  const proposedPolls = polls.filter(p => p.status === 'proposed');
  const activePolls = polls.filter(p => p.status === 'active');
  const closedPolls = polls.filter(p => p.status === 'closed');

  return (
    React.createElement('div', { className: "container mx-auto p-4 animate-fadeIn" },
      React.createElement('div', { className: "flex justify-between items-center mb-6" },
        React.createElement('h2', { className: "text-3xl font-bold text-condo-primary flex items-center" }, 
          React.createElement(ChartPieIcon, { className: "w-8 h-8 mr-2"}), "Sondaggi e Votazioni"
        ),
        React.createElement('button', {
            onClick: openModalForNew,
            className: "bg-condo-primary hover:bg-condo-primary-dark text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition duration-300 flex items-center"
        }, React.createElement(PlusIcon, { className: "w-5 h-5 mr-2" }), isAdmin ? "Nuovo Sondaggio" : "Proponi Sondaggio")
      ),
      isAdmin && proposedPolls.length > 0 && (
        React.createElement('div', { className: "mb-8" },
            React.createElement('h3', { className: "text-2xl font-semibold text-condo-dark-text mb-4" }, "Sondaggi Proposti (In Attesa di Approvazione)"),
            React.createElement('div', { className: "space-y-6" },
                proposedPolls.map(poll => (
                    React.createElement('div', { key: poll.id, className: "bg-white p-6 rounded-lg shadow-lg border border-yellow-300" },
                        React.createElement('h4', { className: "text-xl font-semibold text-condo-dark-text mb-2" }, poll.question),
                        React.createElement('p', { className: "text-xs text-slate-500 mb-1" }, `Proposto da: ${poll.proposedBy || 'N/D'} il ${new Date(poll.createdDate).toLocaleDateString('it-IT')}`),
                        React.createElement('span', { className: `px-2 py-0.5 text-xs font-semibold rounded-full mb-3 inline-block ${getStatusLabelAndColor(poll.status).color}`}, getStatusLabelAndColor(poll.status).label),
                        React.createElement('ul', { className: "list-disc list-inside text-sm text-slate-600 mb-3 pl-4" },
                            poll.options.map(opt => React.createElement('li', {key: opt.id}, opt.text))
                        ),
                        React.createElement('div', { className: "flex space-x-3" },
                            React.createElement('button', { onClick: () => handleApproveProposal(poll.id), className: "bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded-md text-sm flex items-center"}, React.createElement(CheckCircleIcon, {className:"w-4 h-4 mr-1"}), " Approva"),
                            React.createElement('button', { onClick: () => openEditModal(poll), className: "bg-sky-500 hover:bg-sky-600 text-white px-3 py-1 rounded-md text-sm flex items-center"}, React.createElement(PencilIcon, {className:"w-4 h-4 mr-1"}), " Modifica e Approva"),
                            React.createElement('button', { onClick: () => handleRejectProposal(poll.id), className: "bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-md text-sm flex items-center"}, React.createElement(XCircleIcon, {className:"w-4 h-4 mr-1"}), " Rigetta")
                        )
                    )
                ))
            ),
            React.createElement('hr', {className: "my-8"})
        )
      ),
      ([...activePolls, ...closedPolls].length === 0 && (!isAdmin || proposedPolls.length === 0)) ? (
        React.createElement('p', { className: "text-slate-600 text-center py-10" },
            (isAdmin && polls.filter(p => p.status !== 'proposed').length === 0 && proposedPolls.length > 0) ? 
             "Nessun sondaggio attivo o chiuso. Controlla le proposte." :
             "Nessun sondaggio attivo o passato."
        )
      ) : (
        React.createElement('div', { className: "space-y-6" },
          activePolls.map((poll) => {
            const userVotedOption = getUserVote(poll.id);
            const totalVotes = getTotalVotes(poll);
            const {label: statusLabel, color: statusColor } = getStatusLabelAndColor(poll.status);
            return (
              React.createElement('div', { key: poll.id, className: "bg-white p-6 rounded-lg shadow-lg border border-slate-200" },
                React.createElement('div', { className: "flex justify-between items-start" },
                    React.createElement('h3', { className: "text-xl font-semibold text-condo-dark-text mb-2" }, poll.question),
                    isAdmin && (
                        React.createElement('div', { className: "flex space-x-2" },
                            React.createElement('button', { onClick: () => openEditModal(poll), className: "text-sky-600 hover:text-sky-800", title: "Modifica Sondaggio" }, React.createElement(PencilIcon, { className: "w-5 h-5" })),
                            React.createElement('button', { onClick: () => handleDelete(poll.id), className: "text-red-500 hover:text-red-700", title: "Elimina Sondaggio" }, React.createElement(TrashIcon, { className: "w-5 h-5" }))
                        )
                    )
                ),
                React.createElement('p', { className: "text-xs text-slate-500 mb-1" }, `Creato da: ${poll.createdBy} il ${new Date(poll.createdDate).toLocaleDateString('it-IT')}`),
                poll.endDate && React.createElement('p', { className: "text-xs text-slate-500 mb-3" }, `Termina il: ${new Date(poll.endDate).toLocaleDateString('it-IT')}`),
                React.createElement('span', { className: `px-2 py-0.5 text-xs font-semibold rounded-full mb-3 inline-block ${statusColor}`}, statusLabel),
                React.createElement('div', { className: "space-y-3 mt-2" },
                  poll.options.map((option) => (
                      React.createElement('button', {
                        key: option.id, onClick: () => handleVote(poll.id, option.id),
                        disabled: !!userVotedOption || poll.status !== 'active',
                        className: `w-full text-left p-3 border rounded-md transition-colors ${userVotedOption === option.id ? 'bg-condo-secondary text-white border-emerald-400 ring-2 ring-emerald-500' : 'border-slate-300 hover:bg-slate-50'} ${!!userVotedOption || poll.status !== 'active' ? 'cursor-not-allowed opacity-70' : ''}`
                      }, option.text,
                        (userVotedOption && poll.status === 'active') && (
                            React.createElement('span', {className: "text-xs block mt-1"}, `${getVoteCount(poll, option.id)} voti (${(totalVotes > 0 ? (getVoteCount(poll, option.id) / totalVotes * 100) : 0).toFixed(1)}%)`)
                        )
                      )
                    ))
                ),
                (userVotedOption && poll.status === 'active') && React.createElement('p', {className: "text-sm text-green-600 mt-3"}, `Hai votato per: ${poll.options.find(o=>o.id === userVotedOption)?.text}`),
                React.createElement('p', { className: "text-sm text-slate-600 mt-4" }, `Voti totali: ${totalVotes}`)
              )
            );
          }),
          closedPolls.map((poll) => {
            const totalVotes = getTotalVotes(poll);
            const {label: statusLabel, color: statusColor } = getStatusLabelAndColor(poll.status);
             return (
              React.createElement('div', { key: poll.id, className: "bg-white p-6 rounded-lg shadow-lg border border-slate-200 opacity-80" },
                React.createElement('div', { className: "flex justify-between items-start" },
                    React.createElement('h3', { className: "text-xl font-semibold text-slate-600 mb-2" }, poll.question),
                    isAdmin && (
                         React.createElement('div', { className: "flex space-x-2" },
                            React.createElement('button', { onClick: () => openEditModal(poll), className: "text-sky-500 hover:text-sky-700", title: "Modifica Sondaggio Chiuso"}, React.createElement(PencilIcon, { className: "w-5 h-5" })),
                            React.createElement('button', { onClick: () => handleDelete(poll.id), className: "text-red-400 hover:text-red-600", title: "Elimina Sondaggio Chiuso"}, React.createElement(TrashIcon, { className: "w-5 h-5" }))
                        )
                    )
                ),
                React.createElement('p', { className: "text-xs text-slate-400 mb-1" }, `Creato da: ${poll.createdBy} il ${new Date(poll.createdDate).toLocaleDateString('it-IT')}`),
                poll.endDate && React.createElement('p', { className: "text-xs text-slate-400 mb-3" }, `Terminato il: ${new Date(poll.endDate).toLocaleDateString('it-IT')}`),
                 React.createElement('span', { className: `px-2 py-0.5 text-xs font-semibold rounded-full mb-3 inline-block ${statusColor}`}, statusLabel),
                React.createElement('div', { className: "space-y-3 mt-2" },
                  poll.options.map((option) => {
                    const voteCount = getVoteCount(poll, option.id);
                    const percentage = totalVotes > 0 ? ((voteCount / totalVotes) * 100).toFixed(1) : 0;
                    return (
                      React.createElement('div', { key: option.id, className: "p-3 border border-slate-200 rounded-md" },
                        React.createElement('div', { className: "flex justify-between items-center mb-1" },
                          React.createElement('span', {className: `${getUserVote(poll.id) === option.id ? 'font-bold text-condo-primary' : 'text-slate-700'}`}, option.text),
                          React.createElement('span', { className: "text-sm text-slate-500" }, `${voteCount} voti (${percentage}%)`)
                        ),
                        React.createElement('div', { className: "w-full bg-slate-200 rounded-full h-2.5" },
                          React.createElement('div', { className: "bg-condo-secondary h-2.5 rounded-full", style: { width: `${percentage}%` } })
                        )
                      )
                    );
                  })
                ),
                React.createElement('p', { className: "text-sm text-slate-500 mt-4" }, `Voti totali: ${totalVotes}`)
              )
            );
          })
        )
      ),
      React.createElement(Modal, { 
        isOpen: isModalOpen, 
        onClose: () => { setIsModalOpen(false); setEditingId(null); setCurrentPoll({ options: [{id:'opt1', text:''},{id:'opt2', text:''}]});}, 
        title: editingId ? "Modifica Sondaggio" : (isAdmin ? "Nuovo Sondaggio" : "Proponi Sondaggio")} ,
        React.createElement('div', { className: "space-y-4 max-h-[70vh] overflow-y-auto pr-2" },
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "pollQuestion", className: "block text-sm font-medium text-slate-700 mb-1" }, "Domanda del Sondaggio*"),
            React.createElement('input', {
              type: "text", id: "pollQuestion", value: currentPoll.question || '',
              onChange: (e) => setCurrentPoll({ ...currentPoll, question: e.target.value }),
              className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
            })
          ),
          React.createElement('div', null,
            React.createElement('label', { className: "block text-sm font-medium text-slate-700 mb-1" }, "Opzioni di Risposta*"),
            currentPoll.options?.map((option, index) => (
              React.createElement('div', { key: option.id || index, className: "flex items-center space-x-2 mb-2" },
                React.createElement('input', {
                  type: "text", value: option.text,
                  onChange: (e) => handleOptionChange(index, e.target.value),
                  className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
                  placeholder: `Opzione ${index + 1}`
                }),
                (currentPoll.options?.length || 0) > 2 && (
                  React.createElement('button', { onClick: () => removeOption(index), className: "text-red-500 hover:text-red-700 p-1" }, 
                    React.createElement(TrashIcon, { className: "w-5 h-5" })
                  )
                )
              )
            )),
            React.createElement('button', { onClick: addOption, className: "text-sm text-condo-primary hover:underline mt-1" }, "Aggiungi Opzione")
          ),
          isAdmin && ( 
            React.createElement(React.Fragment, null,
              React.createElement('div', null,
                  React.createElement('label', { htmlFor: "pollEndDate", className: "block text-sm font-medium text-slate-700 mb-1" }, "Data di Fine (Opzionale)"),
                  React.createElement('input', { 
                      type: "date", id: "pollEndDate",
                      value: currentPoll.endDate ? currentPoll.endDate.split('T')[0] : '',
                      min: new Date().toISOString().split('T')[0],
                      onChange: (e) => setCurrentPoll({...currentPoll, endDate: e.target.value ? new Date(e.target.value).toISOString() : undefined }),
                      className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
                  })
              ),
              editingId && ( 
                   React.createElement('div', null,
                      React.createElement('label', { htmlFor: "pollStatus", className: "block text-sm font-medium text-slate-700 mb-1" }, "Stato"),
                      React.createElement('select', {
                          id: "pollStatus", value: currentPoll.status || 'active',
                          onChange: (e) => setCurrentPoll({...currentPoll, status: e.target.value}),
                          className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
                      },
                          React.createElement('option', {value: "active"}, "Attivo"),
                          React.createElement('option', {value: "closed"}, "Chiuso"),
                          (polls.find(p=>p.id === editingId)?.status === 'proposed') && React.createElement('option', {value: "proposed"}, "Proposto")
                      )
                  )
              )
            )
          ),
          React.createElement('div', { className: "flex justify-end space-x-3 pt-2" },
            React.createElement('button', {
              onClick: () => { setIsModalOpen(false); setEditingId(null); setCurrentPoll({ options: [{id:'opt1', text:''},{id:'opt2', text:''}] });},
              className: "px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-md border border-slate-300 transition"
            }, "Annulla"),
            React.createElement('button', {
              onClick: handleSave,
              className: "px-4 py-2 text-sm font-medium text-white bg-condo-primary hover:bg-condo-primary-dark rounded-md shadow-sm transition"
            }, editingId ? "Salva Modifiche" : (isAdmin ? "Crea Sondaggio" : "Proponi Sondaggio"))
          )
        )
      )
    )
  );
};

// Content from pages/ForumPage.tsx
const ForumPage = () => {
  const TOPICS_KEY = 'condo_forum_topics';
  const POSTS_KEY_PREFIX = 'condo_forum_posts_';
  const USER_PROFILE_KEY = 'condo_user_profile';


  const [topics, setTopics] = useState([]);
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [newTopicTitle, setNewTopicTitle] = useState('');
  
  const location = useLocation();
  const navigate = useNavigate();
  const queryParams = new URLSearchParams(location.search);
  const selectedTopicId = queryParams.get('topicId');
  
  const [currentUserProfile, setCurrentUserProfile] = useState(null);
  useEffect(() => {
    const profile = getItem(USER_PROFILE_KEY);
    setCurrentUserProfile(profile);
  }, []);
  const currentUserName = currentUserProfile?.name || 'Utente Anonimo';


  const loadTopics = useCallback(() => {
    const storedTopics = getItem(TOPICS_KEY);
    if (storedTopics) {
      setTopics(storedTopics.sort((a,b) => new Date(b.lastPostDate || b.createdDate).getTime() - new Date(a.lastPostDate || a.createdDate).getTime()));
    } else {
      const exampleTopics = [
        {id: 'topic1', title: 'Idee per la festa di condominio estiva', createdBy: 'Anna Verdi', createdDate: new Date(2024,4,20).toISOString(), lastPostDate: new Date(2024,4,22).toISOString(), postCount: 3},
        {id: 'topic2', title: 'Proposta acquisto nuove piante per giardino', createdBy: 'Luca Neri', createdDate: new Date(2024,5,1).toISOString(), lastPostDate: new Date(2024,5,1).toISOString(), postCount: 1},
      ];
      setTopics(exampleTopics.sort((a,b) => new Date(b.lastPostDate || b.createdDate).getTime() - new Date(a.lastPostDate || a.createdDate).getTime()));
      setItem(TOPICS_KEY, exampleTopics);
    }
  }, []);

  useEffect(() => {
    loadTopics();
  }, [loadTopics]);
  
  const selectedTopic = topics.find(t => t.id === selectedTopicId);


  const handleCreateTopic = () => {
    if (!newTopicTitle.trim()) {
      alert("Il titolo del topic è obbligatorio.");
      return;
    }
    const newTopic = {
      id: Date.now().toString(),
      title: newTopicTitle.trim(),
      createdBy: currentUserName,
      createdDate: new Date().toISOString(),
      postCount: 0,
    };
    const updatedTopics = [newTopic, ...topics].sort((a,b) => new Date(b.lastPostDate || b.createdDate).getTime() - new Date(a.lastPostDate || a.createdDate).getTime());
    setTopics(updatedTopics);
    setItem(TOPICS_KEY, updatedTopics);
    setIsModalOpen(false);
    setNewTopicTitle('');
  };

  const handleSelectTopic = (topicId) => {
    navigate(`/forum?topicId=${topicId}`);
  };
  
  const handleBackToTopics = () => {
    navigate('/forum');
    loadTopics(); 
  }

  // TopicView Component defined inline for ForumPage
  const TopicView = ({ topic, onBack }) => {
    const [posts, setPosts] = useState([]);
    const [newPostContent, setNewPostContent] = useState('');
    const postsKey = `${POSTS_KEY_PREFIX}${topic.id}`;

    const loadPostsInner = useCallback(() => { // Renamed to avoid conflict
      const storedPosts = getItem(postsKey);
      setPosts(storedPosts ? storedPosts.sort((a,b) => new Date(a.postedDate).getTime() - new Date(b.postedDate).getTime()) : []);
    }, [postsKey]);

    useEffect(() => {
      loadPostsInner();
    }, [loadPostsInner]);

    const handleAddPost = () => {
      if (!newPostContent.trim()) return;
      const newPost = {
        id: Date.now().toString(),
        topicId: topic.id,
        content: newPostContent.trim(),
        postedBy: currentUserName,
        postedDate: new Date().toISOString(),
      };
      const updatedPosts = [...posts, newPost];
      setPosts(updatedPosts);
      setItem(postsKey, updatedPosts);

      const topicsFromStorage = getItem(TOPICS_KEY) || [];
      const updatedTopicsForStorage = topicsFromStorage.map(t => t.id === topic.id ? {...t, lastPostDate: newPost.postedDate, postCount: (t.postCount || 0) + 1} : t);
      setItem(TOPICS_KEY, updatedTopicsForStorage);
      
      // Update the main topics state in ForumPage as well
      setTopics(prevTopics => prevTopics.map(t => t.id === topic.id ? {...t, lastPostDate: newPost.postedDate, postCount: (t.postCount || 0) + 1} : t)
                                     .sort((a,b) => new Date(b.lastPostDate || b.createdDate).getTime() - new Date(a.lastPostDate || a.createdDate).getTime()));


      setNewPostContent('');
    };

    return (
      React.createElement('div', { className: "animate-fadeIn" },
          React.createElement('div', { className: "flex justify-between items-center mb-4" },
              React.createElement('button', { onClick: onBack, className: "text-condo-primary hover:underline"}, "\u2190 Torna ai Topic")
          ),
        React.createElement('h3', { className: "text-2xl font-bold text-condo-primary mb-1" }, topic.title),
        React.createElement('p', { className: "text-xs text-slate-500 mb-6" }, `Creato da: ${topic.createdBy} il ${new Date(topic.createdDate).toLocaleDateString('it-IT')}`),
        React.createElement('div', { className: "space-y-4 mb-6 max-h-[50vh] overflow-y-auto pr-2 bg-slate-50 p-4 rounded-md" },
          posts.length === 0 ? (
            React.createElement('p', { className: "text-slate-500 text-center" }, "Nessun messaggio in questo topic. Sii il primo a scrivere!")
          ) : (
            posts.map(post => (
              React.createElement('div', { key: post.id, className: "bg-white p-4 rounded-md shadow border border-slate-200" },
                React.createElement('p', { className: "text-sm text-slate-700 whitespace-pre-wrap" }, post.content),
                React.createElement('p', { className: "text-xs text-slate-500 mt-2" },
                  `Da: ${post.postedBy} - ${new Date(post.postedDate).toLocaleString('it-IT', { day:'2-digit', month:'short', year:'numeric', hour:'2-digit', minute:'2-digit'})}`
                )
              )
            ))
          )
        ),
        React.createElement('div', { className: "mt-6" },
          React.createElement('h4', { className: "text-lg font-semibold text-condo-dark-text mb-2" }, "Aggiungi un commento:"),
          React.createElement('textarea', {
            value: newPostContent,
            onChange: (e) => setNewPostContent(e.target.value),
            rows: 4,
            className: "w-full p-3 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
            placeholder: "Scrivi il tuo messaggio..."
          }),
          React.createElement('button', {
            onClick: handleAddPost,
            className: "mt-3 bg-condo-secondary hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition duration-300 flex items-center"
          }, React.createElement(PaperAirplaneIcon, { className: "w-5 h-5 mr-2 transform rotate-[-45deg]"}), " Invia Messaggio")
        )
      )
    );
  };


  if (selectedTopic) {
    return React.createElement(TopicView, { topic: selectedTopic, onBack: handleBackToTopics });
  }

  return (
    React.createElement('div', { className: "container mx-auto p-4 animate-fadeIn" },
      React.createElement('div', { className: "flex justify-between items-center mb-6" },
        React.createElement('h2', { className: "text-3xl font-bold text-condo-primary flex items-center" }, React.createElement(ChatBubbleBottomCenterTextIcon, {className:"w-8 h-8 mr-2"}), "Forum Condominiale"),
        React.createElement('div', { className: "flex space-x-2" },
            React.createElement('button', {
                onClick: loadTopics,
                className: "bg-slate-200 hover:bg-slate-300 text-slate-700 font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition duration-300 flex items-center",
                title: "Aggiorna elenco topic"
            }, React.createElement(ArrowPathIcon, { className: "w-5 h-5" })),
            React.createElement('button', {
              onClick: () => setIsModalOpen(true),
              className: "bg-condo-primary hover:bg-condo-primary-dark text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition duration-300 flex items-center"
            }, React.createElement(PlusIcon, { className: "w-5 h-5 mr-2" }), "Nuovo Topic")
        )
      ),
      topics.length === 0 ? (
        React.createElement('p', { className: "text-slate-600 text-center py-10" }, "Nessun topic presente. Crea il primo!")
      ) : (
        React.createElement('div', { className: "space-y-3" },
          topics.map((topic) => (
            React.createElement('div', { 
                key: topic.id, 
                className: "bg-white p-4 rounded-lg shadow border border-slate-200 hover:shadow-md hover:border-condo-primary transition-all cursor-pointer",
                onClick: () => handleSelectTopic(topic.id)
            },
              React.createElement('h3', { className: "text-lg font-semibold text-condo-dark-text hover:text-condo-primary" }, topic.title),
              React.createElement('p', { className: "text-xs text-slate-500" },
                `Creato da: ${topic.createdBy} il ${new Date(topic.createdDate).toLocaleDateString('it-IT')}`
              ),
              React.createElement('div', { className: "flex justify-between items-center mt-1" },
                React.createElement('p', { className: "text-xs text-slate-500" }, `Messaggi: ${topic.postCount}`),
                topic.lastPostDate && React.createElement('p', { className: "text-xs text-slate-500" }, `Ultimo msg: ${new Date(topic.lastPostDate).toLocaleString('it-IT', { day:'numeric', month:'short', hour:'2-digit', minute:'2-digit' })}`)
              )
            )
          ))
        )
      ),
      React.createElement(Modal, { isOpen: isModalOpen, onClose: () => setIsModalOpen(false), title: "Crea Nuovo Topic di Discussione" },
        React.createElement('div', { className: "space-y-4" },
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "topicTitle", className: "block text-sm font-medium text-slate-700 mb-1" }, "Titolo del Topic*"),
            React.createElement('input', {
              type: "text", id: "topicTitle", value: newTopicTitle,
              onChange: (e) => setNewTopicTitle(e.target.value),
              className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
              placeholder: "Oggetto della discussione..."
            })
          ),
          React.createElement('div', { className: "flex justify-end space-x-3" },
            React.createElement('button', {
              onClick: () => { setIsModalOpen(false); setNewTopicTitle(''); },
              className: "px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-md border border-slate-300 transition"
            }, "Annulla"),
            React.createElement('button', {
              onClick: handleCreateTopic,
              className: "px-4 py-2 text-sm font-medium text-white bg-condo-primary hover:bg-condo-primary-dark rounded-md shadow-sm transition"
            }, "Crea Topic")
          )
        )
      )
    )
  );
};

// Content from pages/FeesPage.tsx
const FeesPage = () => {
  const FEES_KEY = 'condo_fees';
  const USER_PROFILE_KEY = 'condo_user_profile';

  const [fees, setFees] = useState([]);
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [currentFee, setCurrentFee] = useState({});
  const [editingId, setEditingId] = useState(null);
  const [filter, setFilter] = useState('all');
  const [currentUserProfile, setCurrentUserProfile] = useState(null);

  useEffect(() => {
    const profile = getItem(USER_PROFILE_KEY);
    setCurrentUserProfile(profile);
  }, []);
  
  const isAdmin = currentUserProfile?.isAdmin || false;

  const loadFees = useCallback(() => {
    let storedFees = getItem(FEES_KEY);
    if (!storedFees || storedFees.length === 0) {
      const exampleFees = [
        { id: '1', description: 'Rata condominiale Maggio 2024', amount: 120.50, dueDate: new Date(2024, 4, 31).toISOString(), status: 'Da Pagare' },
        { id: '2', description: 'Quota straordinaria facciata', amount: 300.00, dueDate: new Date(2024, 3, 15).toISOString(), status: 'Pagata', paymentDate: new Date(2024,3,10).toISOString() },
        { id: '3', description: 'Rata condominiale Aprile 2024', amount: 120.50, dueDate: new Date(2024, 3, 30).toISOString(), status: 'In Ritardo' },
        { id: '4', description: 'Conguaglio riscaldamento 2023', amount: 75.20, dueDate: new Date(2024, 2, 28).toISOString(), status: 'Pagata', paymentDate: new Date(2024,2,20).toISOString() },
      ];
      storedFees = exampleFees;
      setItem(FEES_KEY, storedFees);
    }
    
    const today = new Date().toISOString();
    const updatedFees = storedFees.map(fee => {
        if (fee.status === 'Da Pagare' && fee.dueDate < today) {
            return {...fee, status: 'In Ritardo'};
        }
        return fee;
    });
    setFees(updatedFees.sort((a,b) => new Date(b.dueDate).getTime() - new Date(a.dueDate).getTime()));
  }, []);

  useEffect(() => {
    loadFees();
  }, [loadFees]);

  const updateAndStoreFees = (updatedFeesList) => {
    const sortedFees = updatedFeesList.sort((a,b) => new Date(b.dueDate).getTime() - new Date(a.dueDate).getTime());
    setFees(sortedFees);
    setItem(FEES_KEY, sortedFees);
  };

  const handleSave = () => { 
    if (!isAdmin) return;
    if (!currentFee.description || !currentFee.amount || !currentFee.dueDate) {
      alert("Descrizione, importo e data scadenza sono obbligatori.");
      return;
    }
    let newFeeList;
    if(editingId) {
        newFeeList = fees.map(f => f.id === editingId ? {...f, ...currentFee, amount: Number(currentFee.amount)} : f);
    } else {
        const newFeeEntry = {
            id: Date.now().toString(),
            description: currentFee.description,
            amount: Number(currentFee.amount),
            dueDate: currentFee.dueDate,
            status: currentFee.status || 'Da Pagare',
        };
        newFeeList = [newFeeEntry, ...fees];
    }
    
    updateAndStoreFees(newFeeList);
    setIsModalOpen(false);
    setCurrentFee({});
    setEditingId(null);
  };

  const handleDelete = (id) => { 
    if (!isAdmin) return;
    if (window.confirm("Sei sicuro di voler eliminare questa rata?")) {
        const updatedFeeList = fees.filter(f => f.id !== id);
        updateAndStoreFees(updatedFeeList);
    }
  };

  const handleMarkAsPaid = (id) => {
    const updatedFeeList = fees.map(fee => {
      if (fee.id === id) {
        return { ...fee, status: 'Pagata', paymentDate: new Date().toISOString() };
      }
      return fee;
    });
    updateAndStoreFees(updatedFeeList);
    alert(`Rata segnata come pagata (simulazione).`);
  };

  const openAddModal = () => {
    if (!isAdmin) return;
    setCurrentFee({ status: 'Da Pagare', dueDate: new Date().toISOString().split('T')[0] });
    setEditingId(null);
    setIsModalOpen(true);
  };

  const openEditModal = (fee) => {
    if (!isAdmin) return;
    setCurrentFee({...fee, dueDate: fee.dueDate.split('T')[0]});
    setEditingId(fee.id);
    setIsModalOpen(true);
  };

  const getStatusColor = (status) => {
    switch (status) {
      case 'Pagata': return 'bg-green-100 text-green-700';
      case 'In Ritardo': return 'bg-red-100 text-red-700';
      case 'Da Pagare': return 'bg-yellow-100 text-yellow-700';
      default: return 'bg-slate-100 text-slate-700';
    }
  };

  const filteredFees = fees.filter(fee => filter === 'all' || fee.status === filter);
  const totalDue = filteredFees.filter(f => f.status === 'Da Pagare' || f.status === 'In Ritardo').reduce((sum, f) => sum + f.amount, 0);

  return (
    React.createElement('div', { className: "container mx-auto p-4 animate-fadeIn" },
      React.createElement('div', { className: "flex flex-wrap justify-between items-center mb-6 gap-4" },
        React.createElement('h2', { className: "text-3xl font-bold text-condo-primary flex items-center" }, 
          React.createElement(CreditCardIcon, { className: "w-8 h-8 mr-2"}), "Rate Condominiali"
        ),
        isAdmin && (
          React.createElement('button', {
            onClick: openAddModal,
            className: "bg-condo-primary hover:bg-condo-primary-dark text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition duration-300 flex items-center"
          }, React.createElement(PlusIcon, { className: "w-5 h-5 mr-2" }), "Aggiungi Rata")
        )
      ),
      React.createElement('div', { className: "mb-6 flex flex-wrap items-center gap-4 bg-white p-4 rounded-lg shadow" },
        React.createElement('label', { htmlFor: "feeFilter", className: "text-sm font-medium text-slate-700" }, "Filtra per stato:"),
        React.createElement('select', {
            id: "feeFilter", value: filter,
            onChange: (e) => setFilter(e.target.value),
            className: "px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
        },
            React.createElement('option', {value: "all"}, "Tutte"),
            React.createElement('option', {value: "Da Pagare"}, "Da Pagare"),
            React.createElement('option', {value: "Pagata"}, "Pagata"),
            React.createElement('option', {value: "In Ritardo"}, "In Ritardo")
        ),
        React.createElement('div', { className: "ml-auto text-right" },
            React.createElement('p', { className: "text-sm text-slate-600" }, "Totale da pagare (filtrato):"),
            React.createElement('p', { className: "text-xl font-bold text-condo-dark-text" }, `€ ${totalDue.toFixed(2)}`)
        )
      ),
      filteredFees.length === 0 ? (
        React.createElement('p', { className: "text-slate-600 text-center py-10" }, "Nessuna rata trovata per il filtro selezionato.")
      ) : (
        React.createElement('div', { className: "space-y-4" },
          filteredFees.map((fee) => (
            React.createElement('div', { key: fee.id, className: "bg-white p-5 rounded-lg shadow-lg border border-slate-200 hover:shadow-xl transition-shadow" },
              React.createElement('div', { className: "flex flex-wrap justify-between items-start gap-2" },
                React.createElement('div', null,
                    React.createElement('h3', { className: "text-lg font-semibold text-condo-dark-text" }, fee.description),
                    React.createElement('p', { className: "text-2xl font-bold text-condo-primary mt-1" }, `€ ${fee.amount.toFixed(2)}`)
                ),
                React.createElement('div', { className: "flex items-center space-x-2" },
                    isAdmin && (
                         React.createElement(React.Fragment, null,
                            React.createElement('button', { onClick: () => openEditModal(fee), className: "text-sky-600 hover:text-sky-800", title: "Modifica Rata"}, React.createElement(PencilIcon, { className: "w-5 h-5" })),
                            React.createElement('button', { onClick: () => handleDelete(fee.id), className: "text-red-500 hover:text-red-700", title: "Elimina Rata"}, React.createElement(TrashIcon, { className: "w-5 h-5" }))
                        )
                    ),
                    React.createElement('span', { className: `px-3 py-1 text-xs font-semibold rounded-full ${getStatusColor(fee.status)}`}, fee.status)
                )
              ),
              React.createElement('p', { className: "text-sm text-slate-600 mt-1" }, `Scadenza: ${new Date(fee.dueDate).toLocaleDateString('it-IT')}`),
              fee.status === 'Pagata' && fee.paymentDate && (
                React.createElement('p', { className: "text-sm text-green-600" }, `Pagata il: ${new Date(fee.paymentDate).toLocaleDateString('it-IT')}`)
              ),
              fee.notes && React.createElement('p', { className: "text-xs italic text-slate-500 mt-1" }, "Note: ", fee.notes),
              (fee.status === 'Da Pagare' || fee.status === 'In Ritardo') && !isAdmin && (
                React.createElement('div', { className: "mt-4 text-right" },
                  React.createElement('button', {
                    onClick: () => handleMarkAsPaid(fee.id),
                    className: "bg-condo-secondary hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow hover:shadow-md transition duration-150"
                  }, "Simula Pagamento")
                )
              )
            )
          ))
        )
      ),
      isAdmin && (
        React.createElement(Modal, { isOpen: isModalOpen, onClose: () => {setIsModalOpen(false); setCurrentFee({}); setEditingId(null);}, title: editingId ? "Modifica Rata" : "Aggiungi Nuova Rata"},
          React.createElement('div', { className: "space-y-4" },
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "feeDesc", className: "block text-sm font-medium text-slate-700 mb-1" }, "Descrizione*"),
              React.createElement('input', {
                type: "text", id: "feeDesc", value: currentFee.description || '',
                onChange: (e) => setCurrentFee({ ...currentFee, description: e.target.value }),
                className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
                placeholder: "Es. Rata condominiale Giugno 2024"
              })
            ),
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "feeAmount", className: "block text-sm font-medium text-slate-700 mb-1" }, "Importo (€)*"),
              React.createElement('input', {
                type: "number", id: "feeAmount", value: currentFee.amount || '',
                onChange: (e) => setCurrentFee({ ...currentFee, amount: parseFloat(e.target.value) }),
                className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary",
                step: "0.01"
              })
            ),
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "feeDueDate", className: "block text-sm font-medium text-slate-700 mb-1" }, "Data Scadenza*"),
              React.createElement('input', {
                type: "date", id: "feeDueDate", value: currentFee.dueDate ? currentFee.dueDate.split('T')[0] : '',
                onChange: (e) => setCurrentFee({ ...currentFee, dueDate: e.target.value ? new Date(e.target.value).toISOString() : '' }),
                className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
              })
            ),
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "feeStatus", className: "block text-sm font-medium text-slate-700 mb-1" }, "Stato Iniziale*"),
              React.createElement('select', {
                id: "feeStatus", value: currentFee.status || 'Da Pagare',
                onChange: (e) => setCurrentFee({ ...currentFee, status: e.target.value }),
                className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
              },
                React.createElement('option', {value: "Da Pagare"}, "Da Pagare"),
                React.createElement('option', {value: "Pagata"}, "Pagata"),
                React.createElement('option', {value: "In Ritardo"}, "In Ritardo")
              )
            ),
            currentFee.status === 'Pagata' && (
                 React.createElement('div', null,
                    React.createElement('label', { htmlFor: "feePaymentDate", className: "block text-sm font-medium text-slate-700 mb-1" }, "Data Pagamento (se già pagata)"),
                    React.createElement('input', {
                        type: "date", id: "feePaymentDate", value: currentFee.paymentDate ? currentFee.paymentDate.split('T')[0] : '',
                        onChange: (e) => setCurrentFee({ ...currentFee, paymentDate: e.target.value ? new Date(e.target.value).toISOString() : undefined }),
                        className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
                    })
                )
            ),
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "feeNotes", className: "block text-sm font-medium text-slate-700 mb-1" }, "Note (Opzionale)"),
              React.createElement('textarea', {
                id: "feeNotes", rows: 2, value: currentFee.notes || '',
                onChange: (e) => setCurrentFee({ ...currentFee, notes: e.target.value }),
                className: "w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary"
              })
            ),
            React.createElement('div', { className: "flex justify-end space-x-3" },
              React.createElement('button', { onClick: () => { setIsModalOpen(false); setCurrentFee({}); setEditingId(null);}, className: "px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-md border border-slate-300 transition" }, "Annulla"),
              React.createElement('button', { onClick: handleSave, className: "px-4 py-2 text-sm font-medium text-white bg-condo-primary hover:bg-condo-primary-dark rounded-md shadow-sm transition"}, editingId ? "Salva Modifiche" : "Aggiungi Rata")
            )
          )
        )
      )
    )
  );
};

// Content from pages/ProfilePage.tsx
const ProfilePage = () => {
  const USER_PROFILE_KEY = 'condo_user_profile';
  const CURRENT_USER_ID = 'main_user'; 

  const [profile, setProfile] = useState(null);
  const [isEditing, setIsEditing] = useState(false);
  const [editData, setEditData] = useState({});
  const [isUnitModalOpen, setIsUnitModalOpen] = useState(false);
  const [currentUnit, setCurrentUnit] = useState({});
  const [editingUnitId, setEditingUnitId] = useState(null);

  const loadProfile = useCallback(() => {
    let userProfile = getItem(USER_PROFILE_KEY);
    if (!userProfile) {
      userProfile = {
        id: CURRENT_USER_ID, name: 'Mario Rossi', email: 'mario.rossi@email.com', phone: '333-1234567',
        isAdmin: true, 
        units: [
          { id: 'unit1', address: 'Appartamento 12B, Scala A', type: 'appartamento' },
          { id: 'unit2', address: 'Garage N.5', type: 'garage' },
        ],
      };
      setItem(USER_PROFILE_KEY, userProfile);
    }
    setProfile(userProfile);
    setEditData(userProfile);
  }, []);

  useEffect(() => {
    loadProfile();
  }, [loadProfile]);

  const handleSaveProfile = () => {
    if (editData.name && editData.email) {
      const updatedProfile = { ...profile, ...editData };
      setProfile(updatedProfile);
      setItem(USER_PROFILE_KEY, updatedProfile);
      setIsEditing(false);
    } else {
      alert("Nome e email sono obbligatori.");
    }
  };

  const handleUnitSave = () => {
    if (!currentUnit.address || !currentUnit.type) {
        alert("Indirizzo e tipo unità sono obbligatori.");
        return;
    }
    if (!profile) return;

    let updatedUnits;
    if(editingUnitId) {
        updatedUnits = profile.units.map(u => u.id === editingUnitId ? {...u, ...currentUnit} : u);
    } else {
        const newUnit = {
            id: `unit-${Date.now()}`,
            address: currentUnit.address,
            type: currentUnit.type,
        };
        updatedUnits = [...profile.units, newUnit];
    }
    const updatedProfile = {...profile, units: updatedUnits};
    setProfile(updatedProfile);
    setItem(USER_PROFILE_KEY, updatedProfile);
    setIsUnitModalOpen(false);
    setCurrentUnit({});
    setEditingUnitId(null);
  }

  const openAddUnitModal = () => {
    setCurrentUnit({type: 'appartamento'});
    setEditingUnitId(null);
    setIsUnitModalOpen(true);
  }
  const openEditUnitModal = (unit) => {
    setCurrentUnit({...unit});
    setEditingUnitId(unit.id);
    setIsUnitModalOpen(true);
  }
  const handleDeleteUnit = (unitId) => {
    if(!profile) return;
    if(window.confirm("Sei sicuro di voler eliminare questa unità immobiliare?")) {
        const updatedUnits = profile.units.filter(u => u.id !== unitId);
        const updatedProfile = {...profile, units: updatedUnits};
        setProfile(updatedProfile);
        setItem(USER_PROFILE_KEY, updatedProfile);
    }
  }

  if (!profile) {
    return React.createElement('div', { className: "text-center p-10" }, "Caricamento profilo...");
  }

  return (
    React.createElement('div', { className: "container mx-auto p-4 animate-fadeIn" },
      React.createElement('div', { className: "flex justify-between items-center mb-6" },
        React.createElement('h2', { className: "text-3xl font-bold text-condo-primary flex items-center" },
          React.createElement(UserCircleIcon, { className: "w-10 h-10 mr-3" }), "Il Mio Profilo"
        ),
        !isEditing && (
          React.createElement('button', {
            onClick: () => { setEditData({...profile}); setIsEditing(true); },
            className: "bg-condo-primary hover:bg-condo-primary-dark text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition duration-300 flex items-center"
          }, React.createElement(PencilIcon, { className: "w-5 h-5 mr-2" }), "Modifica Profilo")
        )
      ),
      React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-lg border border-slate-200" },
        isEditing ? (
          React.createElement('div', { className: "space-y-4" },
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "profileName", className: "block text-sm font-medium text-slate-700" }, "Nome Completo"),
              React.createElement('input', {
                type: "text", id: "profileName", value: editData.name || '',
                onChange: (e) => setEditData({ ...editData, name: e.target.value }),
                className: "mt-1 block w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary sm:text-sm"
              })
            ),
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "profileEmail", className: "block text-sm font-medium text-slate-700" }, "Email"),
              React.createElement('input', {
                type: "email", id: "profileEmail", value: editData.email || '',
                onChange: (e) => setEditData({ ...editData, email: e.target.value }),
                className: "mt-1 block w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary sm:text-sm"
              })
            ),
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "profilePhone", className: "block text-sm font-medium text-slate-700" }, "Telefono"),
              React.createElement('input', {
                type: "tel", id: "profilePhone", value: editData.phone || '',
                onChange: (e) => setEditData({ ...editData, phone: e.target.value }),
                className: "mt-1 block w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary sm:text-sm"
              })
            ),
            React.createElement('div', { className: "flex justify-end space-x-3" },
              React.createElement('button', { onClick: () => setIsEditing(false), className: "px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-md border border-slate-300 transition" }, "Annulla"),
              React.createElement('button', { onClick: handleSaveProfile, className: "px-4 py-2 text-sm font-medium text-white bg-condo-primary hover:bg-condo-primary-dark rounded-md shadow-sm transition" }, "Salva Modifiche")
            )
          )
        ) : (
          React.createElement('div', { className: "space-y-3" },
            React.createElement('p', { className: "text-lg" }, React.createElement('span', {className: "font-semibold text-condo-dark-text"}, "Nome: "), profile.name),
            React.createElement('p', { className: "text-lg" }, React.createElement('span', {className: "font-semibold text-condo-dark-text"}, "Email: "), profile.email),
            React.createElement('p', { className: "text-lg" }, React.createElement('span', {className: "font-semibold text-condo-dark-text"}, "Telefono: "), profile.phone || 'Non specificato'),
            profile.isAdmin && React.createElement('p', { className: "text-sm text-condo-secondary font-semibold"}, "Accesso Amministratore Attivo")
          )
        )
      ),
      React.createElement('div', { className: "mt-8" },
        React.createElement('div', { className: "flex justify-between items-center mb-4" },
            React.createElement('h3', { className: "text-2xl font-semibold text-condo-dark-text" }, "Le Mie Unità Immobiliari"),
            React.createElement('button', {
                onClick: openAddUnitModal,
                className: "bg-condo-secondary hover:bg-emerald-600 text-white font-semibold py-2 px-3 rounded-lg shadow-md hover:shadow-lg transition duration-300 flex items-center text-sm"
            }, React.createElement(PlusIcon, { className: "w-4 h-4 mr-1" }), "Aggiungi Unità")
        ),
        profile.units.length === 0 ? (
          React.createElement('p', { className: "text-slate-600 bg-white p-4 rounded-md shadow border" }, "Nessuna unità immobiliare associata.")
        ) : (
          React.createElement('div', { className: "space-y-3" },
            profile.units.map(unit => (
              React.createElement('div', { key: unit.id, className: "bg-white p-4 rounded-md shadow border border-slate-200 flex justify-between items-center" },
                React.createElement('div', null,
                    React.createElement('p', { className: "font-medium text-slate-700" }, unit.address),
                    React.createElement('p', { className: "text-sm text-slate-500 capitalize" }, unit.type)
                ),
                React.createElement('div', { className: "space-x-2" },
                    React.createElement('button', { onClick: () => openEditUnitModal(unit), className: "text-sky-600 hover:text-sky-800 p-1", title: "Modifica Unità" }, React.createElement(PencilIcon, {className:"w-5 h-5"})),
                    React.createElement('button', { onClick: () => handleDeleteUnit(unit.id), className: "text-red-500 hover:text-red-700 p-1", title: "Elimina Unità" }, React.createElement(TrashIcon, {className:"w-5 h-5"}))
                )
              )
            ))
          )
        )
      ),
      React.createElement(Modal, { isOpen: isUnitModalOpen, onClose: () => { setIsUnitModalOpen(false); setCurrentUnit({}); setEditingUnitId(null); }, title: editingUnitId ? "Modifica Unità Immobiliare" : "Aggiungi Unità Immobiliare" },
        React.createElement('div', { className: "space-y-4" },
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "unitAddress", className: "block text-sm font-medium text-slate-700" }, "Indirizzo Unità*"),
              React.createElement('input', {
                type: "text", id: "unitAddress", value: currentUnit.address || '',
                onChange: (e) => setCurrentUnit({ ...currentUnit, address: e.target.value }),
                className: "mt-1 block w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary sm:text-sm",
                placeholder: "Es. Appartamento 10, Scala B"
              })
            ),
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "unitType", className: "block text-sm font-medium text-slate-700" }, "Tipo Unità*"),
              React.createElement('select', {
                id: "unitType", value: currentUnit.type || 'appartamento',
                onChange: (e) => setCurrentUnit({ ...currentUnit, type: e.target.value }),
                className: "mt-1 block w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-condo-primary focus:border-condo-primary sm:text-sm"
              },
                React.createElement('option', {value: "appartamento"}, "Appartamento"),
                React.createElement('option', {value: "garage"}, "Garage"),
                React.createElement('option', {value: "cantina"}, "Cantina"),
                React.createElement('option', {value: "posto_auto"}, "Posto Auto")
              )
            ),
            React.createElement('div', { className: "flex justify-end space-x-3 pt-2" },
              React.createElement('button', { onClick: () => { setIsUnitModalOpen(false); setCurrentUnit({}); setEditingUnitId(null);}, className: "px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-md border border-slate-300 transition" }, "Annulla"),
              React.createElement('button', { onClick: handleUnitSave, className: "px-4 py-2 text-sm font-medium text-white bg-condo-primary hover:bg-condo-primary-dark rounded-md shadow-sm transition"}, editingUnitId ? "Salva Modifiche" : "Aggiungi Unità")
            )
        )
      )
    )
  );
};

// Content from pages/AccountingPage.tsx
const AccountingPage = () => {
  return (
    React.createElement('div', { className: "container mx-auto p-4 animate-fadeIn" },
      React.createElement('div', { className: "flex items-center mb-6" },
        React.createElement(BanknotesIcon, { className: "w-10 h-10 text-condo-primary mr-3" }),
        React.createElement('h2', { className: "text-3xl font-bold text-condo-primary" }, "Gestione Contabile")
      ),
      React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-lg border border-slate-200" },
        React.createElement('p', { className: "text-slate-600 mb-6" },
          "Questa sezione è dedicata alla gestione contabile del condominio. Le funzionalità complete richiederebbero un'integrazione backend sicura e complessa. Di seguito sono elencate le aree che verrebbero coperte."
        ),
        React.createElement('div', { className: "space-y-8" },
          React.createElement('div', null,
            React.createElement('h3', { className: "text-xl font-semibold text-condo-dark-text mb-3 flex items-center" },
              React.createElement(UsersIcon, { className: "w-6 h-6 mr-2 text-condo-secondary" }), "Anagrafiche Condomini e Fornitori"
            ),
            React.createElement('p', { className: "text-sm text-slate-500" },
              "Gestione dei dati anagrafici dei condomini, proprietà associate, millesimi, e anagrafica dei fornitori del condominio."
            ),
            React.createElement('div', { className: "mt-3 bg-slate-100 p-4 rounded-md text-center text-slate-500" },
              "(Placeholder per tabelle e form di gestione anagrafiche)"
            )
          ),
          React.createElement('div', null,
            React.createElement('h3', { className: "text-xl font-semibold text-condo-dark-text mb-3 flex items-center" },
              React.createElement(CreditCardIcon, { className: "w-6 h-6 mr-2 text-red-500" }), "Gestione Morosità"
            ),
            React.createElement('p', { className: "text-sm text-slate-500" },
              "Monitoraggio delle rate non pagate, solleciti di pagamento, e storico delle morosità."
            ),
            React.createElement('div', { className: "mt-3 bg-slate-100 p-4 rounded-md text-center text-slate-500" },
              "(Placeholder per tabelle di visualizzazione morosità e strumenti di sollecito)"
            )
          ),
          React.createElement('div', null,
            React.createElement('h3', { className: "text-xl font-semibold text-condo-dark-text mb-3 flex items-center" },
              React.createElement(DocumentTextIcon, { className: "w-6 h-6 mr-2 text-sky-600" }), "Bilanci ed Estratti Conto"
            ),
            React.createElement('p', { className: "text-sm text-slate-500" },
              "Redazione e consultazione di bilanci preventivi e consuntivi. Generazione di estratti conto per i singoli condomini. Gestione prima nota e movimenti contabili."
            ),
            React.createElement('div', { className: "mt-3 bg-slate-100 p-4 rounded-md text-center text-slate-500" },
              "(Placeholder per caricamento/generazione documenti contabili e report)"
            )
          ),
           React.createElement('div', null,
            React.createElement('h3', { className: "text-xl font-semibold text-condo-dark-text mb-3 flex items-center" },
              React.createElement(BanknotesIcon, { className: "w-6 h-6 mr-2 text-emerald-600" }), "Pagamenti Fornitori e Fatturazione"
            ),
            React.createElement('p', { className: "text-sm text-slate-500" },
              "Registrazione fatture fornitori, pianificazione e tracciamento pagamenti."
            ),
            React.createElement('div', { className: "mt-3 bg-slate-100 p-4 rounded-md text-center text-slate-500" },
              "(Placeholder per gestione fatture e pagamenti)"
            )
          )
        ),
        React.createElement('p', { className: "mt-10 text-sm text-slate-500 text-center" },
          "Le funzionalità di contabilità complete sono complesse e richiedono robusti sistemi di backend per la sicurezza e l'integrità dei dati. Questa pagina serve come dimostrazione concettuale."
        )
      )
    )
  );
};

// Content from pages/RegistrationPage.tsx
const RegistrationPage = ({ onRegistrationSuccess, adminMode, userProfile }) => {
  const USER_PROFILE_KEY = 'condo_user_profile';
  const CURRENT_USER_ID = 'main_user';

  const [fullName, setFullName] = useState('');
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [confirmPassword, setConfirmPassword] = useState('');
  const [profileType, setProfileType] = useState('condomino');
  const [error, setError] = useState(null);
  const [successMessage, setSuccessMessage] = useState(null);

  useEffect(() => {
    if (adminMode && userProfile) {
      setFullName(userProfile.name);
      setEmail(userProfile.email);
      setProfileType(userProfile.isAdmin ? 'amministratore' : 'condomino');
    }
  }, [adminMode, userProfile]);

  const validateEmail = (emailAddr) => {
    const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return re.test(String(emailAddr).toLowerCase());
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    setError(null);
    setSuccessMessage(null);

    if (!fullName || !email) {
      setError("Nome completo e email sono obbligatori.");
      return;
    }
    if (!validateEmail(email)) {
      setError("Formato email non valido.");
      return;
    }
    if (!adminMode || password || confirmPassword) {
      if (!password || password.length < 8) {
        setError("La password deve contenere almeno 8 caratteri.");
        return;
      }
      if (password !== confirmPassword) {
        setError("Le password non coincidono.");
        return;
      }
    }

    const existingUnits = adminMode && userProfile ? userProfile.units : [];
    const existingPhone = adminMode && userProfile ? userProfile.phone : '';

    const newUserProfile = {
      id: CURRENT_USER_ID,
      name: fullName,
      email: email,
      phone: existingPhone,
      units: existingUnits,
      isAdmin: profileType === 'amministratore',
    };

    try {
      setItem(USER_PROFILE_KEY, newUserProfile);
      const message = adminMode 
        ? `Profilo principale resettato/aggiornato per ${fullName}!`
        : `Registrazione completata con successo per ${fullName}! Verrai reindirizzato a breve.`;
      setSuccessMessage(message);
      
      setPassword('');
      setConfirmPassword('');

      if (!adminMode) {
        setFullName('');
        setEmail('');
        setProfileType('condomino');
      }
      
      setTimeout(() => {
        onRegistrationSuccess();
      }, adminMode ? 2000 : 1500);
      
    } catch (err) {
      console.error("Errore durante il salvataggio del profilo:", err);
      setError("Si è verificato un errore durante la registrazione. Riprova.");
    }
  };
  
  const pageTitle = adminMode ? "Resetta/Aggiorna Profilo Principale" : "Registra un Nuovo Account";
  const buttonText = adminMode ? "Aggiorna Profilo" : "Registrati";

  return (
    React.createElement('div', { className: `flex items-center justify-center min-h-screen bg-slate-100 p-4 ${successMessage ? '' : 'animate-fadeIn'}` },
      React.createElement('div', { className: "max-w-lg w-full mx-auto bg-white p-8 rounded-xl shadow-2xl" },
        React.createElement('div', { className: "flex flex-col items-center mb-6" },
          React.createElement(UserPlusIcon, { className: "w-16 h-16 text-condo-primary mb-3" }),
          React.createElement('h2', { className: "text-3xl font-bold text-condo-dark-text text-center" }, pageTitle),
          adminMode && React.createElement('p', {className: "text-sm text-slate-600 mt-1 text-center"}, "Modifica i dati del profilo principale. La password può essere aggiornata se necessario.")
        ),
        error && (
          React.createElement('div', { className: "mb-4 p-3 bg-red-100 text-red-700 border border-red-300 rounded-md text-sm" }, error)
        ),
        successMessage && (
          React.createElement('div', { className: "mb-4 p-3 bg-green-100 text-green-700 border border-green-300 rounded-md text-sm" }, successMessage)
        ),
        !successMessage && (
        React.createElement('form', { onSubmit: handleSubmit, className: "space-y-6" },
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "fullName", className: "block text-sm font-medium text-slate-700 mb-1" }, "Nome Completo"),
            React.createElement('input', {
              type: "text", id: "fullName", value: fullName,
              onChange: (e) => setFullName(e.target.value),
              className: "w-full px-4 py-3 border border-slate-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-condo-primary focus:border-transparent transition-shadow",
              required: true
            })
          ),
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "email", className: "block text-sm font-medium text-slate-700 mb-1" }, "Email"),
            React.createElement('input', {
              type: "email", id: "email", value: email,
              onChange: (e) => setEmail(e.target.value),
              className: "w-full px-4 py-3 border border-slate-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-condo-primary focus:border-transparent transition-shadow",
              required: true
            })
          ),
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "password", 'aria-describedby': "passwordHelp", className: "block text-sm font-medium text-slate-700 mb-1" }, `Password ${adminMode ? '(lascia vuoto per non cambiare)' : ''}`),
            React.createElement('input', {
              type: "password", id: "password", value: password,
              onChange: (e) => setPassword(e.target.value),
              className: "w-full px-4 py-3 border border-slate-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-condo-primary focus:border-transparent transition-shadow",
              required: !adminMode
            }),
            React.createElement('p', {id: "passwordHelp", className: "mt-1 text-xs text-slate-500"}, "Minimo 8 caratteri se impostata.")
          ),
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "confirmPassword", className: "block text-sm font-medium text-slate-700 mb-1" }, `Conferma Password ${adminMode ? '(lascia vuoto per non cambiare)' : ''}`),
            React.createElement('input', {
              type: "password", id: "confirmPassword", value: confirmPassword,
              onChange: (e) => setConfirmPassword(e.target.value),
              className: "w-full px-4 py-3 border border-slate-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-condo-primary focus:border-transparent transition-shadow",
              required: !adminMode && !!password
            })
          ),
          React.createElement('div', null,
            React.createElement('label', { htmlFor: "profileType", className: "block text-sm font-medium text-slate-700 mb-1" }, "Tipo di Profilo"),
            React.createElement('select', {
              id: "profileType", value: profileType,
              onChange: (e) => setProfileType(e.target.value),
              className: "w-full px-4 py-3 border border-slate-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-condo-primary focus:border-transparent transition-shadow bg-white"
            },
              React.createElement('option', { value: "condomino" }, "Condomino"),
              React.createElement('option', { value: "amministratore" }, "Amministratore")
            )
          ),
          React.createElement('div', null,
            React.createElement('button', {
              type: "submit",
              className: "w-full bg-condo-primary hover:bg-condo-primary-dark text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transition duration-300 focus:outline-none focus:ring-2 focus:ring-condo-primary focus:ring-opacity-50"
            }, buttonText)
          )
        ))
      )
    )
  );
};


// Content from App.tsx
const USER_PROFILE_KEY = 'condo_user_profile';

const App = () => {
  const [isRegistered, setIsRegistered] = useState(null);
  const [currentUserProfile, setCurrentUserProfile] = useState(null);

  const checkRegistration = useCallback(() => {
    const profile = getItem(USER_PROFILE_KEY);
    if (profile) {
      setCurrentUserProfile(profile);
      setIsRegistered(true);
    } else {
      setCurrentUserProfile(null);
      setIsRegistered(false);
    }
  }, []);

  useEffect(() => {
    checkRegistration();
  }, [checkRegistration]);

  const handleRegistrationSuccess = () => {
    checkRegistration(); 
  };

  const handleLogout = () => {
    if (window.confirm("Sei sicuro di voler effettuare il logout?")) {
      removeItem(USER_PROFILE_KEY);
      setCurrentUserProfile(null);
      setIsRegistered(false);
    }
  };

  const navLinkClass = ({ isActive }) =>
    `flex items-center px-4 py-3 hover:bg-condo-primary-dark transition-colors duration-200 ${
      isActive ? 'bg-condo-primary-dark text-white font-semibold' : 'text-sky-100 hover:text-white'
    }`;
  
  const buttonLinkClass = `flex items-center px-4 py-3 text-sky-100 hover:text-white hover:bg-condo-primary-dark transition-colors duration-200 w-full text-left`;

  let baseNavItems = [
    { path: '/', name: 'Bacheca', icon: React.createElement(HomeIcon, {className: "w-5 h-5 mr-3"}) },
    { path: '/avvisi', name: 'Avvisi', icon: React.createElement(BellIcon, {className: "w-5 h-5 mr-3"}) },
    { path: '/documenti', name: 'Documenti', icon: React.createElement(DocumentTextIcon, {className: "w-5 h-5 mr-3"}) },
    { path: '/segnalazioni', name: 'Segnalazioni', icon: React.createElement(WrenchScrewdriverIcon, {className: "w-5 h-5 mr-3"}) },
    { path: '/prenotazioni', name: 'Prenotazioni', icon: React.createElement(CalendarDaysIcon, {className: "w-5 h-5 mr-3"}) },
    { path: '/pacchi', name: 'Consegna Pacchi', icon: React.createElement(CubeTransparentIcon, {className: "w-5 h-5 mr-3"}) },
    { path: '/sondaggi', name: 'Sondaggi', icon: React.createElement(ChartPieIcon, {className: "w-5 h-5 mr-3"}) },
    { path: '/forum', name: 'Forum', icon: React.createElement(ChatBubbleBottomCenterTextIcon, {className: "w-5 h-5 mr-3"}) },
    { path: '/contatti', name: 'Contatti Utili', icon: React.createElement(UsersIcon, {className: "w-5 h-5 mr-3"}) },
    { path: '/profilo', name: 'Il Mio Profilo', icon: React.createElement(UserCircleIcon, {className: "w-5 h-5 mr-3"}) },
  ];
  
  const adminNavItems = [
    { path: '/admin/contabilita', name: 'Contabilità', icon: React.createElement(BanknotesIcon, {className: "w-5 h-5 mr-3"}) },
    { path: '/registrazione-admin', name: 'Registra/Reset Profilo', icon: React.createElement(UserPlusIcon, {className: "w-5 h-5 mr-3"}) },
  ];

  let navItems = [...baseNavItems]; // Create a mutable copy

  if (currentUserProfile) {
    if (currentUserProfile.isAdmin) {
      navItems = navItems.filter(item => item.path !== '/rate');
    } else {
      const feesItem = { path: '/rate', name: 'Rate Condominiali', icon: React.createElement(CreditCardIcon, {className: "w-5 h-5 mr-3"}) };
      const contactsIndex = navItems.findIndex(item => item.path === '/contatti');
      if (contactsIndex !== -1) {
        navItems.splice(contactsIndex, 0, feesItem);
      } else {
        navItems.push(feesItem);
      }
    }
  }


  if (isRegistered === null) {
    return (
      React.createElement('div', { className: "flex h-screen w-screen items-center justify-center bg-slate-100" },
        React.createElement('div', { className: "animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-condo-primary" })
      )
    );
  }

  return (
    React.createElement(HashRouter, null,
      !isRegistered ? (
        React.createElement(Routes, null,
          React.createElement(Route, { path: "*", element: React.createElement(RegistrationPage, { onRegistrationSuccess: handleRegistrationSuccess }) })
        )
      ) : (
        React.createElement('div', { className: "flex h-screen bg-slate-100" },
          React.createElement('aside', { className: "w-72 bg-condo-primary text-white flex flex-col shadow-lg" },
            React.createElement('div', { className: "flex items-center justify-center h-20 border-b border-condo-primary-dark" },
              React.createElement(BuildingOfficeIcon, { className: "w-10 h-10 text-sky-300 mr-2" }),
              React.createElement('h1', { className: "text-2xl font-bold text-white" }, "Il Mio Condominio")
            ),
            React.createElement('nav', { className: "flex-grow mt-2 overflow-y-auto" },
              React.createElement('span', { className: "block px-4 pt-3 pb-1 text-xs text-sky-200 uppercase font-semibold" }, "Menu Principale"),
              navItems.map((item) => (
                React.createElement(NavLink, { key: item.path, to: item.path, className: navLinkClass, end: item.path === '/' },
                  item.icon,
                  item.name
                )
              )),
              currentUserProfile?.isAdmin && (
                React.createElement(React.Fragment, null,
                  React.createElement('span', { className: "block px-4 pt-4 pb-1 text-xs text-sky-200 uppercase font-semibold" }, "Area Amministrazione"),
                  adminNavItems.map((item) => (
                    React.createElement(NavLink, { key: item.path, to: item.path, className: navLinkClass, end: false },
                      item.icon,
                      item.name
                    )
                  ))
                )
              ),
              React.createElement('div', { className: "mt-auto pt-2 border-t border-condo-primary-dark" },
                React.createElement('button', { onClick: handleLogout, className: buttonLinkClass },
                  React.createElement(ArrowLeftOnRectangleIcon, { className: "w-5 h-5 mr-3" }),
                  "Logout"
                )
              )
            ),
            React.createElement('div', { className: "p-4 border-t border-condo-primary-dark text-center text-sky-200 text-xs" },
               `© ${new Date().getFullYear()} Gestione Condominiale`
            )
          ),
          React.createElement('main', { className: "flex-1 p-6 overflow-y-auto" },
            React.createElement(Routes, null,
              React.createElement(Route, { path: "/", element: React.createElement(DashboardPage) }),
              React.createElement(Route, { path: "/avvisi", element: React.createElement(AnnouncementsPage) }),
              React.createElement(Route, { path: "/documenti", element: React.createElement(DocumentsPage) }),
              React.createElement(Route, { path: "/segnalazioni", element: React.createElement(IssuesPage) }),
              React.createElement(Route, { path: "/prenotazioni", element: React.createElement(ReservationsPage) }),
              React.createElement(Route, { path: "/pacchi", element: React.createElement(PackageNotificationsPage) }),
              React.createElement(Route, { path: "/sondaggi", element: React.createElement(PollsPage) }),
              React.createElement(Route, { path: "/forum", element: React.createElement(ForumPage) }),
              !currentUserProfile?.isAdmin && React.createElement(Route, { path: "/rate", element: React.createElement(FeesPage) }),
              React.createElement(Route, { path: "/contatti", element: React.createElement(ContactsPage) }),
              React.createElement(Route, { path: "/profilo", element: React.createElement(ProfilePage) }),
              currentUserProfile?.isAdmin && (
                React.createElement(React.Fragment, null,
                  React.createElement(Route, { path: "/admin/contabilita", element: React.createElement(AccountingPage) }),
                  React.createElement(Route, { path: "/registrazione-admin", element: React.createElement(RegistrationPage, { onRegistrationSuccess: handleRegistrationSuccess, adminMode: true, userProfile: currentUserProfile }) })
                )
              ),
              React.createElement(Route, { path: "*", element: React.createElement(Navigate, { to: "/", replace: true }) })
            )
          )
        )
      )
    )
  );
};


// Content from index.tsx (ReactDOM rendering)
const rootElement = document.getElementById('root');
if (!rootElement) {
  throw new Error("Impossibile trovare l'elemento root a cui montare l'applicazione.");
}

const root = ReactDOM.createRoot(rootElement);
root.render(
  React.createElement(React.StrictMode, null, 
    React.createElement(App)
  )
);

    </script>
</body>
</html>